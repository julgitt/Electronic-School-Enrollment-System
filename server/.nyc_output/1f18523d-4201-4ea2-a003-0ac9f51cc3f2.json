{"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/adminService.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/adminService.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":30}},"14":{"start":{"line":13,"column":32},"end":{"line":13,"column":74}},"15":{"start":{"line":14,"column":28},"end":{"line":14,"column":63}},"16":{"start":{"line":15,"column":32},"end":{"line":15,"column":74}},"17":{"start":{"line":18,"column":8},"end":{"line":18,"column":43}},"18":{"start":{"line":19,"column":8},"end":{"line":19,"column":49}},"19":{"start":{"line":20,"column":8},"end":{"line":20,"column":45}},"20":{"start":{"line":21,"column":8},"end":{"line":21,"column":53}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":21}},"22":{"start":{"line":25,"column":8},"end":{"line":40,"column":11}},"23":{"start":{"line":26,"column":29},"end":{"line":26,"column":71}},"24":{"start":{"line":27,"column":37},"end":{"line":27,"column":87}},"25":{"start":{"line":28,"column":32},"end":{"line":28,"column":78}},"26":{"start":{"line":29,"column":38},"end":{"line":29,"column":84}},"27":{"start":{"line":30,"column":12},"end":{"line":39,"column":16}},"28":{"start":{"line":30,"column":33},"end":{"line":39,"column":14}},"29":{"start":{"line":31,"column":16},"end":{"line":38,"column":17}},"30":{"start":{"line":31,"column":36},"end":{"line":31,"column":37}},"31":{"start":{"line":32,"column":20},"end":{"line":37,"column":21}},"32":{"start":{"line":33,"column":48},"end":{"line":33,"column":80}},"33":{"start":{"line":34,"column":24},"end":{"line":35,"column":106}},"34":{"start":{"line":35,"column":28},"end":{"line":35,"column":106}},"35":{"start":{"line":36,"column":24},"end":{"line":36,"column":121}},"36":{"start":{"line":43,"column":8},"end":{"line":56,"column":11}},"37":{"start":{"line":44,"column":29},"end":{"line":44,"column":45}},"38":{"start":{"line":45,"column":33},"end":{"line":45,"column":98}},"39":{"start":{"line":46,"column":39},"end":{"line":46,"column":41}},"40":{"start":{"line":47,"column":31},"end":{"line":49,"column":87}},"41":{"start":{"line":48,"column":32},"end":{"line":49,"column":86}},"42":{"start":{"line":50,"column":12},"end":{"line":53,"column":13}},"43":{"start":{"line":51,"column":16},"end":{"line":51,"column":74}},"44":{"start":{"line":52,"column":16},"end":{"line":52,"column":52}},"45":{"start":{"line":54,"column":43},"end":{"line":54,"column":74}},"46":{"start":{"line":54,"column":67},"end":{"line":54,"column":73}},"47":{"start":{"line":55,"column":12},"end":{"line":55,"column":110}},"48":{"start":{"line":59,"column":8},"end":{"line":71,"column":11}},"49":{"start":{"line":60,"column":12},"end":{"line":67,"column":13}},"50":{"start":{"line":61,"column":37},"end":{"line":61,"column":98}},"51":{"start":{"line":62,"column":16},"end":{"line":66,"column":17}},"52":{"start":{"line":63,"column":20},"end":{"line":65,"column":77}},"53":{"start":{"line":68,"column":12},"end":{"line":70,"column":13}},"54":{"start":{"line":69,"column":16},"end":{"line":69,"column":136}},"55":{"start":{"line":74,"column":34},"end":{"line":74,"column":127}},"56":{"start":{"line":74,"column":62},"end":{"line":74,"column":126}},"57":{"start":{"line":75,"column":36},"end":{"line":75,"column":131}},"58":{"start":{"line":75,"column":64},"end":{"line":75,"column":130}},"59":{"start":{"line":76,"column":21},"end":{"line":76,"column":22}},"60":{"start":{"line":77,"column":32},"end":{"line":77,"column":34}},"61":{"start":{"line":78,"column":8},"end":{"line":88,"column":9}},"62":{"start":{"line":79,"column":12},"end":{"line":87,"column":13}},"63":{"start":{"line":80,"column":16},"end":{"line":80,"column":38}},"64":{"start":{"line":82,"column":17},"end":{"line":87,"column":13}},"65":{"start":{"line":83,"column":16},"end":{"line":83,"column":38}},"66":{"start":{"line":85,"column":17},"end":{"line":87,"column":13}},"67":{"start":{"line":86,"column":16},"end":{"line":86,"column":52}},"68":{"start":{"line":89,"column":8},"end":{"line":89,"column":55}},"69":{"start":{"line":92,"column":0},"end":{"line":92,"column":36}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":17,"column":4},"end":{"line":17,"column":5}},"loc":{"start":{"line":17,"column":89},"end":{"line":23,"column":5}},"line":17},"8":{"name":"(anonymous_8)","decl":{"start":{"line":24,"column":4},"end":{"line":24,"column":5}},"loc":{"start":{"line":24,"column":13},"end":{"line":41,"column":5}},"line":24},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":47},"end":{"line":25,"column":48}},"loc":{"start":{"line":25,"column":60},"end":{"line":40,"column":9}},"line":25},"10":{"name":"(anonymous_10)","decl":{"start":{"line":30,"column":26},"end":{"line":30,"column":27}},"loc":{"start":{"line":30,"column":33},"end":{"line":39,"column":14}},"line":30},"11":{"name":"(anonymous_11)","decl":{"start":{"line":30,"column":65},"end":{"line":30,"column":66}},"loc":{"start":{"line":30,"column":78},"end":{"line":39,"column":13}},"line":30},"12":{"name":"(anonymous_12)","decl":{"start":{"line":42,"column":4},"end":{"line":42,"column":5}},"loc":{"start":{"line":42,"column":83},"end":{"line":57,"column":5}},"line":42},"13":{"name":"(anonymous_13)","decl":{"start":{"line":43,"column":47},"end":{"line":43,"column":48}},"loc":{"start":{"line":43,"column":60},"end":{"line":56,"column":9}},"line":43},"14":{"name":"(anonymous_14)","decl":{"start":{"line":48,"column":22},"end":{"line":48,"column":23}},"loc":{"start":{"line":48,"column":32},"end":{"line":49,"column":86}},"line":48},"15":{"name":"(anonymous_15)","decl":{"start":{"line":54,"column":60},"end":{"line":54,"column":61}},"loc":{"start":{"line":54,"column":67},"end":{"line":54,"column":73}},"line":54},"16":{"name":"(anonymous_16)","decl":{"start":{"line":58,"column":4},"end":{"line":58,"column":5}},"loc":{"start":{"line":58,"column":64},"end":{"line":72,"column":5}},"line":58},"17":{"name":"(anonymous_17)","decl":{"start":{"line":59,"column":47},"end":{"line":59,"column":48}},"loc":{"start":{"line":59,"column":60},"end":{"line":71,"column":9}},"line":59},"18":{"name":"(anonymous_18)","decl":{"start":{"line":73,"column":4},"end":{"line":73,"column":5}},"loc":{"start":{"line":73,"column":45},"end":{"line":90,"column":5}},"line":73},"19":{"name":"(anonymous_19)","decl":{"start":{"line":74,"column":57},"end":{"line":74,"column":58}},"loc":{"start":{"line":74,"column":62},"end":{"line":74,"column":126}},"line":74},"20":{"name":"(anonymous_20)","decl":{"start":{"line":75,"column":59},"end":{"line":75,"column":60}},"loc":{"start":{"line":75,"column":64},"end":{"line":75,"column":130}},"line":75}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":34,"column":24},"end":{"line":35,"column":106}},"type":"if","locations":[{"start":{"line":34,"column":24},"end":{"line":35,"column":106}},{"start":{},"end":{}}],"line":34},"6":{"loc":{"start":{"line":50,"column":19},"end":{"line":50,"column":71}},"type":"binary-expr","locations":[{"start":{"line":50,"column":19},"end":{"line":50,"column":44}},{"start":{"line":50,"column":48},"end":{"line":50,"column":71}}],"line":50},"7":{"loc":{"start":{"line":63,"column":90},"end":{"line":65,"column":72}},"type":"cond-expr","locations":[{"start":{"line":64,"column":26},"end":{"line":64,"column":72}},{"start":{"line":65,"column":26},"end":{"line":65,"column":72}}],"line":63},"8":{"loc":{"start":{"line":79,"column":12},"end":{"line":87,"column":13}},"type":"if","locations":[{"start":{"line":79,"column":12},"end":{"line":87,"column":13}},{"start":{"line":82,"column":17},"end":{"line":87,"column":13}}],"line":79},"9":{"loc":{"start":{"line":82,"column":17},"end":{"line":87,"column":13}},"type":"if","locations":[{"start":{"line":82,"column":17},"end":{"line":87,"column":13}},{"start":{"line":85,"column":17},"end":{"line":87,"column":13}}],"line":82},"10":{"loc":{"start":{"line":85,"column":17},"end":{"line":87,"column":13}},"type":"if","locations":[{"start":{"line":85,"column":17},"end":{"line":87,"column":13}},{"start":{},"end":{}}],"line":85}},"s":{"0":1,"1":5,"2":1,"3":2,"4":4,"5":4,"6":0,"7":1,"8":1,"9":1,"10":5,"11":2,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":1},"f":{"0":2,"1":5,"2":1,"3":2,"4":4,"5":1,"6":5,"7":1,"8":1,"9":1,"10":1,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},"b":{"0":[1,1,1],"1":[4,1],"2":[2,2],"3":[0,5],"4":[2,2],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/adminService.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/adminService.ts"],"names":[],"mappings":"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","sourcesContent":["import {SchoolService} from \"./schoolService\";\nimport {ApplicationService} from \"./applicationService\";\nimport {ProfileService} from \"./profileService\";\nimport {CandidateService} from \"./candidateService\";\nimport {Profile} from \"../dto/profile\";\nimport {Application} from \"../dto/application\";\nimport {SchoolWithProfiles} from \"../dto/schoolWithProfiles\";\nimport {Grade} from \"../dto/grade\";\nimport {ITask} from \"pg-promise\";\nimport {ProfileCriteriaEntity, ProfileCriteriaType} from \"../models/profileCriteriaEntity\";\nimport {ApplicationStatus} from \"../dto/applicationStatus\";\nimport {ResourceNotFoundError} from \"../errors/resourceNotFoundError\";\n\nexport class AdminService {\n    constructor(\n        private schoolService: SchoolService,\n        private candidateService: CandidateService,\n        private profileService: ProfileService,\n        private applicationService: ApplicationService,\n        private readonly tx: (callback: (t: ITask<any>) => Promise<void>) => Promise<void>\n    ) {\n    }\n\n    async enroll(): Promise<void> {\n        const profiles: Profile[] = await this.profileService.getAllProfiles();\n        const profilesCriteria: Map<number, ProfileCriteriaEntity[]> = await this.profileService.getAllProfilesCriteria();\n\n        const maxPriority: number = await this.applicationService.getMaxPriority();\n        const gradesByCandidate = await this.candidateService.getAllWithGrades();\n\n        await this.tx(async t => {\n            for (let priority = 1; priority < maxPriority; priority++) {\n                for (let profile of profiles) {\n                    const profileCriteria = profilesCriteria.get(profile.id);\n                    if (!profileCriteria) throw new ResourceNotFoundError('Criteria not found');\n                    await this.processEnrollmentForProfile(profile, profileCriteria, priority, gradesByCandidate, t);\n                }\n            }\n        });\n    }\n\n    private async processEnrollmentForProfile(\n        profile: Profile,\n        criteria: ProfileCriteriaEntity[],\n        priority: number,\n        gradesByCandidate: Map<number, Grade[]>,\n        t: ITask<any>\n    ): Promise<void> {\n        const capacity: number = profile.capacity;\n        let enrolledNumber: number = await this.applicationService.getAllEnrolledByProfile(profile.id);\n        let enrolledCandidateIds: number[] = [];\n\n        let applications: Application[] = (await this.applicationService.getAllPendingApplicationsByProfileAndPriority(profile.id, priority))\n            .sort((a, b) =>\n                this.calculatePoints(criteria, gradesByCandidate.get(a.candidateId)!)\n                - this.calculatePoints(criteria, gradesByCandidate.get(b.candidateId)!)\n            );\n        while (enrolledNumber < capacity && applications.length > 0) {\n            enrolledCandidateIds.push(applications.pop()!.candidateId);\n            enrolledNumber = enrolledNumber + 1;\n        }\n\n        const rejectedApplicationIds = applications.map(app => app.id);\n        await this.updateApplicationStatuses(enrolledCandidateIds, rejectedApplicationIds, profile.id, t);\n    }\n\n    private async updateApplicationStatuses(enrolled: number[], rejected: number[], profileId: number, t: ITask<any>) {\n        for (let candidateId of enrolled) {\n            const applications = await this.applicationService.getAllApplications(candidateId);\n            for (let application of applications) {\n                await this.applicationService.updateApplicationStatus(\n                    application.id,\n                    (application.profile.id === profileId)\n                        ? ApplicationStatus.Accepted\n                        : ApplicationStatus.Rejected,\n                    t\n                );\n            }\n        }\n\n        for (let applicationId of rejected) {\n            await this.applicationService.updateApplicationStatus(applicationId, ApplicationStatus.Rejected, t);\n        }\n\n    }\n\n    private calculatePoints(profileCriteria: ProfileCriteriaEntity[], grades: Grade[]) {\n        const mandatorySubjects = profileCriteria.filter(s => s.type === ProfileCriteriaType.Mandatory);\n        const alternativeSubjects = profileCriteria.filter(s => s.type === ProfileCriteriaType.Alternative);\n        let points = 0;\n\n        let alternativeGrades = []\n        for (let grade of grades) {\n            if (grade.type == \"exam\") {\n                points += grade.grade;\n            } else if (grade.subjectId in mandatorySubjects) {\n                points += grade.grade;\n            } else if (grade.subjectId in alternativeSubjects) {\n                alternativeGrades.push(grade.grade);\n            }\n        }\n        return points + alternativeGrades.sort().pop()!;\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"959eadddbf432458c4f559bf9c055002dc5d9658","contentHash":"816f462764c92a68c0c85f343c9de1aa12e1570edd4137447a4210511831875d"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/models/profileCriteriaEntity.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/models/profileCriteriaEntity.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"2":{"start":{"line":5,"column":0},"end":{"line":8,"column":84}},"3":{"start":{"line":6,"column":4},"end":{"line":6,"column":51}},"4":{"start":{"line":7,"column":4},"end":{"line":7,"column":55}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":1},"end":{"line":5,"column":2}},"loc":{"start":{"line":5,"column":32},"end":{"line":8,"column":1}},"line":5}},"branchMap":{"0":{"loc":{"start":{"line":8,"column":3},"end":{"line":8,"column":82}},"type":"binary-expr","locations":[{"start":{"line":8,"column":3},"end":{"line":8,"column":22}},{"start":{"line":8,"column":27},"end":{"line":8,"column":81}}],"line":8}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/models/profileCriteriaEntity.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/models/profileCriteriaEntity.ts"],"names":[],"mappings":";;;AAAA,IAAY,mBAGX;AAHD,WAAY,mBAAmB;IAC3B,8CAAuB,CAAA;IACvB,kDAA2B,CAAA;AAC/B,CAAC,EAHW,mBAAmB,mCAAnB,mBAAmB,QAG9B","sourcesContent":["export enum ProfileCriteriaType {\n    Mandatory = 'mandatory',\n    Alternative = 'alternative',\n}\n\nexport interface ProfileCriteriaEntity {\n    id: number;\n    profileId: number;\n    subjectId: number;\n    type: ProfileCriteriaType;\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"6b31a3187786ab6801b8ae71e564c55c6d200bd6","contentHash":"78404cd274d22ee82cbbbb1ac8ebb156a48c0d0933e661b299dbe0ad8c76a1dd"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/dto/applicationStatus.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/dto/applicationStatus.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":35}},"2":{"start":{"line":5,"column":0},"end":{"line":9,"column":78}},"3":{"start":{"line":6,"column":4},"end":{"line":6,"column":45}},"4":{"start":{"line":7,"column":4},"end":{"line":7,"column":47}},"5":{"start":{"line":8,"column":4},"end":{"line":8,"column":47}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":1},"end":{"line":5,"column":2}},"loc":{"start":{"line":5,"column":30},"end":{"line":9,"column":1}},"line":5}},"branchMap":{"0":{"loc":{"start":{"line":9,"column":3},"end":{"line":9,"column":76}},"type":"binary-expr","locations":[{"start":{"line":9,"column":3},"end":{"line":9,"column":20}},{"start":{"line":9,"column":25},"end":{"line":9,"column":75}}],"line":9}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/dto/applicationStatus.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/dto/applicationStatus.ts"],"names":[],"mappings":";;;AAAA,IAAY,iBAIX;AAJD,WAAY,iBAAiB;IACzB,wCAAmB,CAAA;IACnB,0CAAqB,CAAA;IACrB,0CAAqB,CAAA;AACzB,CAAC,EAJW,iBAAiB,iCAAjB,iBAAiB,QAI5B","sourcesContent":["export enum ApplicationStatus {\n    Pending = 'pending',\n    Accepted = 'accepted',\n    Rejected = 'rejected',\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"69083a18f3019e557f928dadf6bf398150d58e8c","contentHash":"66ca8915122ef7a332c41305bacbc7514df2ff1c3533ec1aae56430dab60307f"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/resourceNotFoundError.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/resourceNotFoundError.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":39}},"2":{"start":{"line":4,"column":22},"end":{"line":4,"column":46}},"3":{"start":{"line":7,"column":8},"end":{"line":7,"column":28}},"4":{"start":{"line":10,"column":0},"end":{"line":10,"column":54}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":49},"end":{"line":8,"column":5}},"line":6}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":16},"end":{"line":6,"column":47}},"type":"default-arg","locations":[{"start":{"line":6,"column":26},"end":{"line":6,"column":47}}],"line":6}},"s":{"0":1,"1":1,"2":1,"3":0,"4":1},"f":{"0":0},"b":{"0":[0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/resourceNotFoundError.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/resourceNotFoundError.ts"],"names":[],"mappings":";;;AAAA,+CAA0C;AAE1C,MAAa,qBAAsB,SAAQ,yBAAW;IAClD,YAAY,UAAkB,qBAAqB;QAC/C,KAAK,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;IACxB,CAAC;CACJ;AAJD,sDAIC","sourcesContent":["import {CustomError} from \"./customError\";\n\nexport class ResourceNotFoundError extends CustomError {\n    constructor(message: string = 'Data does not exist') {\n        super(message, 404);\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b53d9c539750236ad4ef429a9dca29e1884e85f5","contentHash":"8c54233800886fdca17fce49485ff45437aeb5e20893fe35b8b8f73a45bad463"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/customError.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/customError.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"2":{"start":{"line":6,"column":8},"end":{"line":6,"column":23}},"3":{"start":{"line":7,"column":8},"end":{"line":7,"column":37}},"4":{"start":{"line":8,"column":8},"end":{"line":8,"column":31}},"5":{"start":{"line":9,"column":8},"end":{"line":9,"column":43}},"6":{"start":{"line":10,"column":8},"end":{"line":10,"column":56}},"7":{"start":{"line":13,"column":0},"end":{"line":13,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":4},"end":{"line":5,"column":5}},"loc":{"start":{"line":5,"column":59},"end":{"line":11,"column":5}},"line":5}},"branchMap":{"0":{"loc":{"start":{"line":5,"column":37},"end":{"line":5,"column":57}},"type":"default-arg","locations":[{"start":{"line":5,"column":53},"end":{"line":5,"column":57}}],"line":5}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":1},"f":{"0":0},"b":{"0":[0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/customError.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/customError.ts"],"names":[],"mappings":";;;AAAA,MAAa,WAAY,SAAQ,KAAK;IAKlC,YAAY,OAAe,EAAE,UAAkB,EAAE,gBAAyB,IAAI;QAC1E,KAAK,CAAC,OAAO,CAAC,CAAC;QACf,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAC7B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;QAEnC,KAAK,CAAC,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;IACpD,CAAC;CACJ;AAbD,kCAaC","sourcesContent":["export class CustomError extends Error {\n    public statusCode: number;\n    public message: string;\n    public isOperational: boolean;\n\n    constructor(message: string, statusCode: number, isOperational: boolean = true) {\n        super(message);\n        this.statusCode = statusCode;\n        this.message = message;\n        this.isOperational = isOperational;\n\n        Error.captureStackTrace(this, this.constructor);\n    }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"0a77e772ab0b6915d045e7400c88ac20469223a6","contentHash":"5f4b033fd8a4f4b834f894a8cd0ff14fecc38637543d3a975874b36c8638e980"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/profileService.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/profileService.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":32}},"14":{"start":{"line":13,"column":32},"end":{"line":13,"column":74}},"15":{"start":{"line":16,"column":8},"end":{"line":16,"column":51}},"16":{"start":{"line":19,"column":8},"end":{"line":24,"column":11}},"17":{"start":{"line":20,"column":28},"end":{"line":20,"column":75}},"18":{"start":{"line":21,"column":12},"end":{"line":22,"column":94}},"19":{"start":{"line":22,"column":16},"end":{"line":22,"column":94}},"20":{"start":{"line":23,"column":12},"end":{"line":23,"column":27}},"21":{"start":{"line":27,"column":8},"end":{"line":27,"column":63}},"22":{"start":{"line":30,"column":8},"end":{"line":32,"column":11}},"23":{"start":{"line":31,"column":12},"end":{"line":31,"column":51}},"24":{"start":{"line":35,"column":8},"end":{"line":46,"column":11}},"25":{"start":{"line":36,"column":32},"end":{"line":36,"column":85}},"26":{"start":{"line":37,"column":40},"end":{"line":37,"column":49}},"27":{"start":{"line":38,"column":12},"end":{"line":44,"column":15}},"28":{"start":{"line":40,"column":16},"end":{"line":42,"column":17}},"29":{"start":{"line":41,"column":20},"end":{"line":41,"column":68}},"30":{"start":{"line":43,"column":16},"end":{"line":43,"column":122}},"31":{"start":{"line":45,"column":12},"end":{"line":45,"column":39}},"32":{"start":{"line":49,"column":0},"end":{"line":49,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":35},"end":{"line":17,"column":5}},"line":15},"8":{"name":"(anonymous_8)","decl":{"start":{"line":18,"column":4},"end":{"line":18,"column":5}},"loc":{"start":{"line":18,"column":26},"end":{"line":25,"column":5}},"line":18},"9":{"name":"(anonymous_9)","decl":{"start":{"line":19,"column":47},"end":{"line":19,"column":48}},"loc":{"start":{"line":19,"column":60},"end":{"line":24,"column":9}},"line":19},"10":{"name":"(anonymous_10)","decl":{"start":{"line":26,"column":4},"end":{"line":26,"column":5}},"loc":{"start":{"line":26,"column":34},"end":{"line":28,"column":5}},"line":26},"11":{"name":"(anonymous_11)","decl":{"start":{"line":29,"column":4},"end":{"line":29,"column":5}},"loc":{"start":{"line":29,"column":21},"end":{"line":33,"column":5}},"line":29},"12":{"name":"(anonymous_12)","decl":{"start":{"line":30,"column":47},"end":{"line":30,"column":48}},"loc":{"start":{"line":30,"column":60},"end":{"line":32,"column":9}},"line":30},"13":{"name":"(anonymous_13)","decl":{"start":{"line":34,"column":4},"end":{"line":34,"column":5}},"loc":{"start":{"line":34,"column":29},"end":{"line":47,"column":5}},"line":34},"14":{"name":"(anonymous_14)","decl":{"start":{"line":35,"column":47},"end":{"line":35,"column":48}},"loc":{"start":{"line":35,"column":60},"end":{"line":46,"column":9}},"line":35},"15":{"name":"(anonymous_15)","decl":{"start":{"line":38,"column":32},"end":{"line":38,"column":33}},"loc":{"start":{"line":38,"column":44},"end":{"line":44,"column":13}},"line":38}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":21,"column":12},"end":{"line":22,"column":94}},"type":"if","locations":[{"start":{"line":21,"column":12},"end":{"line":22,"column":94}},{"start":{},"end":{}}],"line":21},"6":{"loc":{"start":{"line":40,"column":16},"end":{"line":42,"column":17}},"type":"if","locations":[{"start":{"line":40,"column":16},"end":{"line":42,"column":17}},{"start":{},"end":{}}],"line":40},"7":{"loc":{"start":{"line":43,"column":16},"end":{"line":43,"column":121}},"type":"cond-expr","locations":[{"start":{"line":43,"column":95},"end":{"line":43,"column":101}},{"start":{"line":43,"column":104},"end":{"line":43,"column":121}}],"line":43},"8":{"loc":{"start":{"line":43,"column":16},"end":{"line":43,"column":92}},"type":"binary-expr","locations":[{"start":{"line":43,"column":16},"end":{"line":43,"column":75}},{"start":{"line":43,"column":79},"end":{"line":43,"column":92}}],"line":43}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/profileService.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/profileService.ts"],"names":[],"mappings":";;;;;;;;;;;;AAGA,2EAAsE;AAEtE,MAAa,cAAc;IACvB,YAAoB,iBAAoC;QAApC,sBAAiB,GAAjB,iBAAiB,CAAmB;IAAG,CAAC;IAEtD,UAAU,CAAC,SAAiB;;YAC9B,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;YAChE,IAAI,CAAC,OAAO;gBAAE,MAAM,IAAI,6CAAqB,CAAC,oBAAoB,CAAC,CAAC;YACpE,OAAO,OAAO,CAAC;QACnB,CAAC;KAAA;IAED,mBAAmB,CAAC,QAAgB;QAChC,OAAO,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;IAC3D,CAAC;IAEK,cAAc;;YAChB,OAAO,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC;QAC3C,CAAC;KAAA;IAEK,sBAAsB;;YACxB,MAAM,WAAW,GAA4B,MAAM,IAAI,CAAC,iBAAiB,CAAC,sBAAsB,EAAE,CAAC;YAEnG,MAAM,mBAAmB,GAAG,IAAI,GAAG,EAAmC,CAAC;YAEvE,WAAW,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;;gBAC3B,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE,CAAC;oBAC/C,mBAAmB,CAAC,GAAG,CAAC,QAAQ,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;gBACpD,CAAC;gBACD,MAAA,mBAAmB,CAAC,GAAG,CAAC,QAAQ,CAAC,SAAS,CAAC,0CAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;YAChE,CAAC,CAAC,CAAC;YAEH,OAAO,mBAAmB,CAAC;QAC/B,CAAC;KAAA;CACJ;AA/BD,wCA+BC","sourcesContent":["import {ProfileRepository} from \"../repositories/profileRepository\";\nimport {ProfileCriteriaEntity} from \"../models/profileCriteriaEntity\";\nimport {Profile} from \"../dto/profile\";\nimport {ResourceNotFoundError} from \"../errors/resourceNotFoundError\";\n\nexport class ProfileService {\n    constructor(private profileRepository: ProfileRepository) {}\n\n    async getProfile(profileId: number): Promise<Profile> {\n        const profile = await this.profileRepository.getById(profileId);\n        if (!profile) throw new ResourceNotFoundError('Profile not found.');\n        return profile;\n    }\n\n    getProfilesBySchool(schoolId: number): Promise<Profile[]> {\n        return this.profileRepository.getAllBySchool(schoolId);\n    }\n\n    async getAllProfiles(): Promise<Profile[]> {\n        return this.profileRepository.getAll();\n    }\n\n    async getAllProfilesCriteria(): Promise< Map<number, ProfileCriteriaEntity[]>> {\n        const allCriteria: ProfileCriteriaEntity[] = await this.profileRepository.getAllProfilesCriteria();\n\n        const profilesCriteriaMap = new Map<number, ProfileCriteriaEntity[]>();\n\n        allCriteria.forEach(criteria => {\n            if (!profilesCriteriaMap.has(criteria.profileId)) {\n                profilesCriteriaMap.set(criteria.profileId, []);\n            }\n            profilesCriteriaMap.get(criteria.profileId)?.push(criteria);\n        });\n\n        return profilesCriteriaMap;\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"27787c3a12a86ac1b97f44c145b8c10aecbda1d7","contentHash":"c98cc008ccf779a0ac366aed9645e18404d6a582ce1d8f40878b23eb82db8494"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/candidateService.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/candidateService.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":34}},"14":{"start":{"line":13,"column":28},"end":{"line":13,"column":66}},"15":{"start":{"line":14,"column":32},"end":{"line":14,"column":74}},"16":{"start":{"line":17,"column":8},"end":{"line":17,"column":41}},"17":{"start":{"line":18,"column":8},"end":{"line":18,"column":55}},"18":{"start":{"line":21,"column":8},"end":{"line":28,"column":11}},"19":{"start":{"line":22,"column":40},"end":{"line":22,"column":47}},"20":{"start":{"line":23,"column":31},"end":{"line":23,"column":70}},"21":{"start":{"line":24,"column":12},"end":{"line":26,"column":13}},"22":{"start":{"line":25,"column":16},"end":{"line":25,"column":111}},"23":{"start":{"line":27,"column":12},"end":{"line":27,"column":39}},"24":{"start":{"line":31,"column":8},"end":{"line":33,"column":11}},"25":{"start":{"line":32,"column":12},"end":{"line":32,"column":73}},"26":{"start":{"line":36,"column":8},"end":{"line":42,"column":11}},"27":{"start":{"line":37,"column":30},"end":{"line":37,"column":72}},"28":{"start":{"line":38,"column":12},"end":{"line":40,"column":13}},"29":{"start":{"line":39,"column":16},"end":{"line":39,"column":96}},"30":{"start":{"line":41,"column":12},"end":{"line":41,"column":29}},"31":{"start":{"line":45,"column":8},"end":{"line":48,"column":11}},"32":{"start":{"line":46,"column":12},"end":{"line":46,"column":48}},"33":{"start":{"line":47,"column":12},"end":{"line":47,"column":58}},"34":{"start":{"line":51,"column":8},"end":{"line":53,"column":11}},"35":{"start":{"line":52,"column":12},"end":{"line":52,"column":65}},"36":{"start":{"line":56,"column":8},"end":{"line":69,"column":11}},"37":{"start":{"line":57,"column":38},"end":{"line":57,"column":96}},"38":{"start":{"line":58,"column":12},"end":{"line":60,"column":13}},"39":{"start":{"line":59,"column":16},"end":{"line":59,"column":111}},"40":{"start":{"line":61,"column":33},"end":{"line":67,"column":13}},"41":{"start":{"line":68,"column":12},"end":{"line":68,"column":71}},"42":{"start":{"line":72,"column":0},"end":{"line":72,"column":44}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":16,"column":4},"end":{"line":16,"column":5}},"loc":{"start":{"line":16,"column":51},"end":{"line":19,"column":5}},"line":16},"8":{"name":"(anonymous_8)","decl":{"start":{"line":20,"column":4},"end":{"line":20,"column":5}},"loc":{"start":{"line":20,"column":23},"end":{"line":29,"column":5}},"line":20},"9":{"name":"(anonymous_9)","decl":{"start":{"line":21,"column":47},"end":{"line":21,"column":48}},"loc":{"start":{"line":21,"column":60},"end":{"line":28,"column":9}},"line":21},"10":{"name":"(anonymous_10)","decl":{"start":{"line":30,"column":4},"end":{"line":30,"column":5}},"loc":{"start":{"line":30,"column":42},"end":{"line":34,"column":5}},"line":30},"11":{"name":"(anonymous_11)","decl":{"start":{"line":31,"column":47},"end":{"line":31,"column":48}},"loc":{"start":{"line":31,"column":60},"end":{"line":33,"column":9}},"line":31},"12":{"name":"(anonymous_12)","decl":{"start":{"line":35,"column":4},"end":{"line":35,"column":5}},"loc":{"start":{"line":35,"column":29},"end":{"line":43,"column":5}},"line":35},"13":{"name":"(anonymous_13)","decl":{"start":{"line":36,"column":47},"end":{"line":36,"column":48}},"loc":{"start":{"line":36,"column":60},"end":{"line":42,"column":9}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":44,"column":4},"end":{"line":44,"column":5}},"loc":{"start":{"line":44,"column":32},"end":{"line":49,"column":5}},"line":44},"15":{"name":"(anonymous_15)","decl":{"start":{"line":45,"column":47},"end":{"line":45,"column":48}},"loc":{"start":{"line":45,"column":60},"end":{"line":48,"column":9}},"line":45},"16":{"name":"(anonymous_16)","decl":{"start":{"line":50,"column":4},"end":{"line":50,"column":5}},"loc":{"start":{"line":50,"column":25},"end":{"line":54,"column":5}},"line":50},"17":{"name":"(anonymous_17)","decl":{"start":{"line":51,"column":47},"end":{"line":51,"column":48}},"loc":{"start":{"line":51,"column":60},"end":{"line":53,"column":9}},"line":51},"18":{"name":"(anonymous_18)","decl":{"start":{"line":55,"column":4},"end":{"line":55,"column":5}},"loc":{"start":{"line":55,"column":32},"end":{"line":70,"column":5}},"line":55},"19":{"name":"(anonymous_19)","decl":{"start":{"line":56,"column":47},"end":{"line":56,"column":48}},"loc":{"start":{"line":56,"column":60},"end":{"line":69,"column":9}},"line":56}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":38,"column":12},"end":{"line":40,"column":13}},"type":"if","locations":[{"start":{"line":38,"column":12},"end":{"line":40,"column":13}},{"start":{},"end":{}}],"line":38},"6":{"loc":{"start":{"line":38,"column":16},"end":{"line":38,"column":63}},"type":"binary-expr","locations":[{"start":{"line":38,"column":16},"end":{"line":38,"column":33}},{"start":{"line":38,"column":37},"end":{"line":38,"column":63}}],"line":38},"7":{"loc":{"start":{"line":58,"column":12},"end":{"line":60,"column":13}},"type":"if","locations":[{"start":{"line":58,"column":12},"end":{"line":60,"column":13}},{"start":{},"end":{}}],"line":58}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/candidateService.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/candidateService.ts"],"names":[],"mappings":";;;;;;;;;;;;AACA,mEAA8D;AAC9D,2EAAsE;AAOtE,MAAa,gBAAgB;IACzB,YACqB,YAA0B,EAC1B,mBAAwC;QADxC,iBAAY,GAAZ,YAAY,CAAc;QAC1B,wBAAmB,GAAnB,mBAAmB,CAAqB;IAC7D,CAAC;IAEK,gBAAgB;;YAClB,MAAM,mBAAmB,GAAG,IAAI,GAAoB,CAAC;YACrD,MAAM,UAAU,GAAgB,MAAM,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE,CAAC;YACxE,KAAK,MAAM,SAAS,IAAI,UAAU,EAAE,CAAC;gBACjC,mBAAmB,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE,EAAE,MAAM,IAAI,CAAC,YAAY,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC;YACnG,CAAC;YACD,OAAO,mBAAmB,CAAC;QAC/B,CAAC;KAAA;IAEK,6BAA6B,CAAC,MAAc;;YAC9C,OAAO,IAAI,CAAC,mBAAmB,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;QACjE,CAAC;KAAA;IAEK,YAAY,CAAC,EAAU,EAAE,MAAc;;YACzC,MAAM,SAAS,GAAqB,MAAM,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YAC/E,IAAI,SAAS,IAAI,IAAI,IAAI,SAAS,CAAC,MAAM,IAAI,MAAM,EAAE,CAAC;gBAClD,MAAM,IAAI,6CAAqB,CAAC,sBAAsB,CAAC,CAAC;YAC5D,CAAC;YACD,OAAO,SAAS,CAAC;QACrB,CAAC;KAAA;IAEK,eAAe,CAAC,EAAU,EAAE,MAAc;;YAC5C,MAAM,IAAI,CAAC,YAAY,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;YACpC,MAAM,IAAI,CAAC,mBAAmB,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;QAClD,CAAC;KAAA;IAEK,YAAY,CAAC,MAAc;;YAC7B,OAAO,IAAI,CAAC,mBAAmB,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;QACzD,CAAC;KAAA;IAEK,QAAQ,CAAC,MAAc,EAAE,SAA2B;;YACtD,MAAM,iBAAiB,GAAqB,MAAM,IAAI,CAAC,mBAAmB,CAAC,UAAU,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;YACvG,IAAI,iBAAiB,EAAE,CAAC;gBACpB,MAAM,IAAI,qCAAiB,CAAC,6CAA6C,CAAC,CAAC;YAC/E,CAAC;YAED,MAAM,YAAY,GAAoB;gBAClC,EAAE,EAAE,CAAC;gBACL,MAAM;gBACN,SAAS,EAAE,SAAS,CAAC,SAAS;gBAC9B,QAAQ,EAAE,SAAS,CAAC,QAAQ;gBAC5B,KAAK,EAAE,SAAS,CAAC,KAAK;aACzB,CAAC;YAEF,OAAO,MAAM,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;QAC/D,CAAC;KAAA;CACJ;AApDD,4CAoDC","sourcesContent":["import {CandidateRepository} from \"../repositories/candidateRepository\";\nimport {DataConflictError} from \"../errors/dataConflictError\";\nimport {ResourceNotFoundError} from \"../errors/resourceNotFoundError\";\nimport {GradeService} from \"./gradeService\";\nimport {Grade} from \"../dto/grade\";\nimport {Candidate} from \"../dto/candidate\";\nimport {CandidateEntity} from \"../models/candidateEntity\";\nimport {CandidateRequest} from \"../dto/candidateRequest\";\n\nexport class CandidateService {\n    constructor(\n        private readonly gradeService: GradeService,\n        private readonly candidateRepository: CandidateRepository) {\n    }\n\n    async getAllWithGrades() {\n        const gradesByCandidateId = new Map<number, Grade[]>;\n        const candidates: Candidate[] = await this.candidateRepository.getAll();\n        for (const candidate of candidates) {\n            gradesByCandidateId.set(candidate.id, await this.gradeService.getAllByCandidate(candidate.id));\n        }\n        return gradesByCandidateId;\n    }\n\n    async getLastCreatedCandidateByUser(userId: number) {\n        return this.candidateRepository.getLastUpdatedByUser(userId);\n    }\n\n    async getCandidate(id: number, userId: number) {\n        const candidate: Candidate | null = await this.candidateRepository.getById(id);\n        if (candidate == null || candidate.userId != userId) {\n            throw new ResourceNotFoundError('Candidate not found.');\n        }\n        return candidate;\n    }\n\n    async deleteCandidate(id: number, userId: number) {\n        await this.getCandidate(id, userId);\n        await this.candidateRepository.deleteById(id);\n    }\n\n    async getAllByUser(userId: number): Promise<Candidate[]> {\n        return this.candidateRepository.getAllByUser(userId);\n    }\n\n    async register(userId: number, candidate: CandidateRequest): Promise<Candidate> {\n        const existingCandidate: Candidate | null = await this.candidateRepository.getByPesel(candidate.pesel);\n        if (existingCandidate) {\n            throw new DataConflictError('There is already candidate with that pesel.');\n        }\n\n        const newCandidate: CandidateEntity = {\n            id: 0,\n            userId,\n            firstName: candidate.firstName,\n            lastName: candidate.lastName,\n            pesel: candidate.pesel,\n        };\n\n        return await this.candidateRepository.insert(newCandidate);\n    }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"79a0298b5d8f472895656be7eb2b0ba67dc11d5f","contentHash":"2a766ab41ea1aca8240b20c98e1fdb01ca007ecd1f7b307eb462f8cc01672f2a"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/dataConflictError.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/dataConflictError.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":35}},"2":{"start":{"line":4,"column":22},"end":{"line":4,"column":46}},"3":{"start":{"line":7,"column":8},"end":{"line":7,"column":28}},"4":{"start":{"line":10,"column":0},"end":{"line":10,"column":46}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":49},"end":{"line":8,"column":5}},"line":6}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":16},"end":{"line":6,"column":47}},"type":"default-arg","locations":[{"start":{"line":6,"column":26},"end":{"line":6,"column":47}}],"line":6}},"s":{"0":1,"1":1,"2":1,"3":0,"4":1},"f":{"0":0},"b":{"0":[0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/dataConflictError.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/dataConflictError.ts"],"names":[],"mappings":";;;AAAA,+CAA0C;AAE1C,MAAa,iBAAkB,SAAQ,yBAAW;IAC9C,YAAY,UAAkB,qBAAqB;QAC/C,KAAK,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;IACxB,CAAC;CACJ;AAJD,8CAIC","sourcesContent":["import {CustomError} from \"./customError\";\n\nexport class DataConflictError extends CustomError {\n    constructor(message: string = 'Data already exists') {\n        super(message, 409);\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b3d6cdf6a26b429ae003b2a5d03eed58f5f52e5a","contentHash":"1456c5a15fbd6524b2873eabf7a43705571458147617bc8b3e258437e698bf8c"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/applicationService.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/applicationService.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":36}},"14":{"start":{"line":13,"column":32},"end":{"line":13,"column":74}},"15":{"start":{"line":14,"column":28},"end":{"line":14,"column":66}},"16":{"start":{"line":15,"column":26},"end":{"line":15,"column":62}},"17":{"start":{"line":16,"column":28},"end":{"line":16,"column":63}},"18":{"start":{"line":19,"column":8},"end":{"line":19,"column":59}},"19":{"start":{"line":20,"column":8},"end":{"line":20,"column":45}},"20":{"start":{"line":21,"column":8},"end":{"line":21,"column":51}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":43}},"22":{"start":{"line":23,"column":8},"end":{"line":23,"column":21}},"23":{"start":{"line":26,"column":8},"end":{"line":45,"column":11}},"24":{"start":{"line":27,"column":33},"end":{"line":27,"column":96}},"25":{"start":{"line":28,"column":12},"end":{"line":44,"column":17}},"26":{"start":{"line":28,"column":57},"end":{"line":44,"column":14}},"27":{"start":{"line":29,"column":54},"end":{"line":33,"column":18}},"28":{"start":{"line":34,"column":16},"end":{"line":43,"column":18}},"29":{"start":{"line":48,"column":8},"end":{"line":50,"column":11}},"30":{"start":{"line":49,"column":12},"end":{"line":49,"column":101}},"31":{"start":{"line":53,"column":8},"end":{"line":56,"column":11}},"32":{"start":{"line":54,"column":33},"end":{"line":54,"column":75}},"33":{"start":{"line":55,"column":12},"end":{"line":55,"column":64}},"34":{"start":{"line":59,"column":8},"end":{"line":61,"column":11}},"35":{"start":{"line":60,"column":12},"end":{"line":60,"column":78}},"36":{"start":{"line":64,"column":8},"end":{"line":66,"column":11}},"37":{"start":{"line":65,"column":12},"end":{"line":65,"column":63}},"38":{"start":{"line":69,"column":8},"end":{"line":71,"column":11}},"39":{"start":{"line":70,"column":12},"end":{"line":70,"column":74}},"40":{"start":{"line":74,"column":8},"end":{"line":89,"column":11}},"41":{"start":{"line":75,"column":31},"end":{"line":75,"column":82}},"42":{"start":{"line":76,"column":12},"end":{"line":77,"column":94}},"43":{"start":{"line":77,"column":16},"end":{"line":77,"column":94}},"44":{"start":{"line":78,"column":41},"end":{"line":78,"column":134}},"45":{"start":{"line":79,"column":12},"end":{"line":80,"column":94}},"46":{"start":{"line":80,"column":16},"end":{"line":80,"column":94}},"47":{"start":{"line":81,"column":12},"end":{"line":81,"column":58}},"48":{"start":{"line":82,"column":12},"end":{"line":82,"column":47}},"49":{"start":{"line":83,"column":12},"end":{"line":88,"column":16}},"50":{"start":{"line":83,"column":33},"end":{"line":88,"column":14}},"51":{"start":{"line":84,"column":16},"end":{"line":87,"column":17}},"52":{"start":{"line":85,"column":43},"end":{"line":85,"column":111}},"53":{"start":{"line":86,"column":20},"end":{"line":86,"column":79}},"54":{"start":{"line":92,"column":8},"end":{"line":110,"column":11}},"55":{"start":{"line":93,"column":31},"end":{"line":93,"column":82}},"56":{"start":{"line":94,"column":12},"end":{"line":95,"column":94}},"57":{"start":{"line":95,"column":16},"end":{"line":95,"column":94}},"58":{"start":{"line":96,"column":33},"end":{"line":96,"column":126}},"59":{"start":{"line":97,"column":12},"end":{"line":98,"column":99}},"60":{"start":{"line":98,"column":16},"end":{"line":98,"column":99}},"61":{"start":{"line":99,"column":12},"end":{"line":99,"column":58}},"62":{"start":{"line":100,"column":12},"end":{"line":100,"column":47}},"63":{"start":{"line":101,"column":12},"end":{"line":109,"column":16}},"64":{"start":{"line":101,"column":33},"end":{"line":109,"column":14}},"65":{"start":{"line":102,"column":16},"end":{"line":104,"column":17}},"66":{"start":{"line":103,"column":20},"end":{"line":103,"column":111}},"67":{"start":{"line":105,"column":16},"end":{"line":108,"column":17}},"68":{"start":{"line":106,"column":43},"end":{"line":106,"column":111}},"69":{"start":{"line":107,"column":20},"end":{"line":107,"column":79}},"70":{"start":{"line":113,"column":8},"end":{"line":122,"column":10}},"71":{"start":{"line":125,"column":8},"end":{"line":129,"column":11}},"72":{"start":{"line":126,"column":12},"end":{"line":128,"column":13}},"73":{"start":{"line":127,"column":16},"end":{"line":127,"column":75}},"74":{"start":{"line":132,"column":8},"end":{"line":132,"column":74}},"75":{"start":{"line":132,"column":49},"end":{"line":132,"column":72}},"76":{"start":{"line":133,"column":8},"end":{"line":135,"column":11}},"77":{"start":{"line":134,"column":12},"end":{"line":134,"column":38}},"78":{"start":{"line":138,"column":32},"end":{"line":138,"column":34}},"79":{"start":{"line":139,"column":8},"end":{"line":152,"column":9}},"80":{"start":{"line":140,"column":30},"end":{"line":140,"column":94}},"81":{"start":{"line":140,"column":60},"end":{"line":140,"column":93}},"82":{"start":{"line":141,"column":12},"end":{"line":147,"column":13}},"83":{"start":{"line":142,"column":16},"end":{"line":145,"column":18}},"84":{"start":{"line":146,"column":16},"end":{"line":146,"column":50}},"85":{"start":{"line":148,"column":12},"end":{"line":151,"column":15}},"86":{"start":{"line":153,"column":8},"end":{"line":153,"column":31}},"87":{"start":{"line":157,"column":0},"end":{"line":157,"column":48}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":18,"column":4},"end":{"line":18,"column":5}},"loc":{"start":{"line":18,"column":93},"end":{"line":24,"column":5}},"line":18},"8":{"name":"(anonymous_8)","decl":{"start":{"line":25,"column":4},"end":{"line":25,"column":5}},"loc":{"start":{"line":25,"column":36},"end":{"line":46,"column":5}},"line":25},"9":{"name":"(anonymous_9)","decl":{"start":{"line":26,"column":47},"end":{"line":26,"column":48}},"loc":{"start":{"line":26,"column":60},"end":{"line":45,"column":9}},"line":26},"10":{"name":"(anonymous_10)","decl":{"start":{"line":28,"column":48},"end":{"line":28,"column":49}},"loc":{"start":{"line":28,"column":57},"end":{"line":44,"column":14}},"line":28},"11":{"name":"(anonymous_11)","decl":{"start":{"line":28,"column":89},"end":{"line":28,"column":90}},"loc":{"start":{"line":28,"column":102},"end":{"line":44,"column":13}},"line":28},"12":{"name":"(anonymous_12)","decl":{"start":{"line":47,"column":4},"end":{"line":47,"column":5}},"loc":{"start":{"line":47,"column":71},"end":{"line":51,"column":5}},"line":47},"13":{"name":"(anonymous_13)","decl":{"start":{"line":48,"column":47},"end":{"line":48,"column":48}},"loc":{"start":{"line":48,"column":60},"end":{"line":50,"column":9}},"line":48},"14":{"name":"(anonymous_14)","decl":{"start":{"line":52,"column":4},"end":{"line":52,"column":5}},"loc":{"start":{"line":52,"column":46},"end":{"line":57,"column":5}},"line":52},"15":{"name":"(anonymous_15)","decl":{"start":{"line":53,"column":47},"end":{"line":53,"column":48}},"loc":{"start":{"line":53,"column":60},"end":{"line":56,"column":9}},"line":53},"16":{"name":"(anonymous_16)","decl":{"start":{"line":58,"column":4},"end":{"line":58,"column":5}},"loc":{"start":{"line":58,"column":39},"end":{"line":62,"column":5}},"line":58},"17":{"name":"(anonymous_17)","decl":{"start":{"line":59,"column":47},"end":{"line":59,"column":48}},"loc":{"start":{"line":59,"column":60},"end":{"line":61,"column":9}},"line":59},"18":{"name":"(anonymous_18)","decl":{"start":{"line":63,"column":4},"end":{"line":63,"column":5}},"loc":{"start":{"line":63,"column":21},"end":{"line":67,"column":5}},"line":63},"19":{"name":"(anonymous_19)","decl":{"start":{"line":64,"column":47},"end":{"line":64,"column":48}},"loc":{"start":{"line":64,"column":60},"end":{"line":66,"column":9}},"line":64},"20":{"name":"(anonymous_20)","decl":{"start":{"line":68,"column":4},"end":{"line":68,"column":5}},"loc":{"start":{"line":68,"column":43},"end":{"line":72,"column":5}},"line":68},"21":{"name":"(anonymous_21)","decl":{"start":{"line":69,"column":47},"end":{"line":69,"column":48}},"loc":{"start":{"line":69,"column":60},"end":{"line":71,"column":9}},"line":69},"22":{"name":"(anonymous_22)","decl":{"start":{"line":73,"column":4},"end":{"line":73,"column":5}},"loc":{"start":{"line":73,"column":45},"end":{"line":90,"column":5}},"line":73},"23":{"name":"(anonymous_23)","decl":{"start":{"line":74,"column":47},"end":{"line":74,"column":48}},"loc":{"start":{"line":74,"column":60},"end":{"line":89,"column":9}},"line":74},"24":{"name":"(anonymous_24)","decl":{"start":{"line":83,"column":26},"end":{"line":83,"column":27}},"loc":{"start":{"line":83,"column":33},"end":{"line":88,"column":14}},"line":83},"25":{"name":"(anonymous_25)","decl":{"start":{"line":83,"column":65},"end":{"line":83,"column":66}},"loc":{"start":{"line":83,"column":78},"end":{"line":88,"column":13}},"line":83},"26":{"name":"(anonymous_26)","decl":{"start":{"line":91,"column":4},"end":{"line":91,"column":5}},"loc":{"start":{"line":91,"column":48},"end":{"line":111,"column":5}},"line":91},"27":{"name":"(anonymous_27)","decl":{"start":{"line":92,"column":47},"end":{"line":92,"column":48}},"loc":{"start":{"line":92,"column":60},"end":{"line":110,"column":9}},"line":92},"28":{"name":"(anonymous_28)","decl":{"start":{"line":101,"column":26},"end":{"line":101,"column":27}},"loc":{"start":{"line":101,"column":33},"end":{"line":109,"column":14}},"line":101},"29":{"name":"(anonymous_29)","decl":{"start":{"line":101,"column":65},"end":{"line":101,"column":66}},"loc":{"start":{"line":101,"column":78},"end":{"line":109,"column":13}},"line":101},"30":{"name":"(anonymous_30)","decl":{"start":{"line":112,"column":4},"end":{"line":112,"column":5}},"loc":{"start":{"line":112,"column":67},"end":{"line":123,"column":5}},"line":112},"31":{"name":"(anonymous_31)","decl":{"start":{"line":124,"column":4},"end":{"line":124,"column":5}},"loc":{"start":{"line":124,"column":39},"end":{"line":130,"column":5}},"line":124},"32":{"name":"(anonymous_32)","decl":{"start":{"line":125,"column":47},"end":{"line":125,"column":48}},"loc":{"start":{"line":125,"column":60},"end":{"line":129,"column":9}},"line":125},"33":{"name":"(anonymous_33)","decl":{"start":{"line":131,"column":4},"end":{"line":131,"column":5}},"loc":{"start":{"line":131,"column":34},"end":{"line":136,"column":5}},"line":131},"34":{"name":"(anonymous_34)","decl":{"start":{"line":132,"column":39},"end":{"line":132,"column":40}},"loc":{"start":{"line":132,"column":49},"end":{"line":132,"column":72}},"line":132},"35":{"name":"(anonymous_35)","decl":{"start":{"line":133,"column":28},"end":{"line":133,"column":29}},"loc":{"start":{"line":133,"column":45},"end":{"line":135,"column":9}},"line":133},"36":{"name":"(anonymous_36)","decl":{"start":{"line":137,"column":4},"end":{"line":137,"column":5}},"loc":{"start":{"line":137,"column":44},"end":{"line":154,"column":5}},"line":137},"37":{"name":"(anonymous_37)","decl":{"start":{"line":140,"column":51},"end":{"line":140,"column":52}},"loc":{"start":{"line":140,"column":60},"end":{"line":140,"column":93}},"line":140}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":76,"column":12},"end":{"line":77,"column":94}},"type":"if","locations":[{"start":{"line":76,"column":12},"end":{"line":77,"column":94}},{"start":{},"end":{}}],"line":76},"6":{"loc":{"start":{"line":79,"column":12},"end":{"line":80,"column":94}},"type":"if","locations":[{"start":{"line":79,"column":12},"end":{"line":80,"column":94}},{"start":{},"end":{}}],"line":79},"7":{"loc":{"start":{"line":94,"column":12},"end":{"line":95,"column":94}},"type":"if","locations":[{"start":{"line":94,"column":12},"end":{"line":95,"column":94}},{"start":{},"end":{}}],"line":94},"8":{"loc":{"start":{"line":97,"column":12},"end":{"line":98,"column":99}},"type":"if","locations":[{"start":{"line":97,"column":12},"end":{"line":98,"column":99}},{"start":{},"end":{}}],"line":97},"9":{"loc":{"start":{"line":141,"column":12},"end":{"line":147,"column":13}},"type":"if","locations":[{"start":{"line":141,"column":12},"end":{"line":147,"column":13}},{"start":{},"end":{}}],"line":141}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/applicationService.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/applicationService.ts"],"names":[],"mappings":"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","sourcesContent":["import {ITask} from \"pg-promise\";\n\nimport {ApplicationRepository} from '../repositories/applicationRepository';\nimport {ResourceNotFoundError} from \"../errors/resourceNotFoundError\";\nimport {DataConflictError} from \"../errors/dataConflictError\";\nimport {SchoolService} from \"./schoolService\";\nimport {ProfileService} from \"./profileService\";\nimport {ApplicationWithProfiles} from \"../dto/applicationWithProfiles\";\nimport {ApplicationBySchool} from \"../dto/applicationBySchool\";\nimport {ApplicationRequest} from \"../dto/applicationRequest\";\nimport {ApplicationEntity} from \"../models/applicationEntity\";\nimport {Application} from \"../dto/application\";\nimport {EnrollmentService} from \"./enrollmentService\";\nimport {ValidationError} from \"../errors/validationError\";\nimport {Enrollment} from \"../dto/enrollment\";\nimport {ApplicationStatus} from \"../dto/applicationStatus\";\n\nexport class ApplicationService {\n    constructor(\n        private applicationRepository: ApplicationRepository,\n        private profileService: ProfileService,\n        private enrollmentService: EnrollmentService,\n        private schoolService: SchoolService,\n        private readonly tx: (callback: (t: ITask<any>) => Promise<void>) => Promise<void>\n    ) {\n    }\n\n    async getAllApplications(candidateId: number): Promise<ApplicationWithProfiles[]> {\n        const applications = await this.applicationRepository.getAllByCandidate(candidateId);\n\n        return Promise.all(\n            applications.map(async (app) => {\n                const [enrollment, profile, school] = await Promise.all([\n                    this.enrollmentService.getEnrollment(app.enrollmentId),\n                    this.profileService.getProfile(app.profileId),\n                    this.schoolService.getSchoolWithProfiles(app.profileId)\n                ]);\n\n                return {\n                    id: app.id,\n                    school: school,\n                    profile: profile,\n                    priority: app.priority,\n                    round: enrollment.round,\n                    status: app.status,\n                    createdAt: app.createdAt,\n                    updatedAt: app.updatedAt\n                };\n            })\n        )\n    }\n\n    async getAllPendingApplicationsByProfileAndPriority(profileId: number, priority: number): Promise<Application[]> {\n        return this.applicationRepository.getAllPendingByProfileAndPriority(profileId, priority);\n    }\n\n    async getAllApplicationSubmissions(candidateId: number): Promise<ApplicationBySchool[]> {\n        const applications: ApplicationWithProfiles[] = await this.getAllApplications(candidateId);\n        return this.groupApplicationsBySchool(applications);\n    }\n\n    async getAllEnrolledByProfile(profileId: number): Promise<number> {\n        return this.applicationRepository.getEnrolledByProfile(profileId)\n    }\n\n    async getMaxPriority(): Promise<number> {\n        return this.applicationRepository.getMaxPriority();\n    }\n\n    async updateApplicationStatus(id: number, status: string, t: ITask<any>) {\n        return this.applicationRepository.updateStatus(id, status, t);\n    }\n\n    async addApplication(submissions: ApplicationRequest[], candidateId: number): Promise<void> {\n        const enrollment: Enrollment | null = await this.enrollmentService.getCurrentEnrollment();\n        if (!enrollment) throw new ValidationError('Outside the enrollment period.');\n\n        const existingApplications: Application[] = await this.applicationRepository.getAllByCandidateAndEnrollmentId(candidateId, enrollment.id);\n        if (existingApplications.length > 0) throw new DataConflictError('Application already exists');\n\n        await this.validateProfilesExist(submissions);\n        this.assignPriorities(submissions);\n\n        await this.tx(async t => {\n            for (const submission of submissions) {\n                const newApplication = this.createApplicationEntity(submission, candidateId, enrollment.id);\n                await this.applicationRepository.insert(newApplication, t);\n            }\n        });\n    }\n\n    async updateApplication(submissions: ApplicationRequest[], candidateId: number): Promise<void> {\n        const enrollment: Enrollment | null = await this.enrollmentService.getCurrentEnrollment();\n        if (!enrollment) throw new ValidationError('Outside the enrollment period.');\n\n        const applications: Application[] = await this.applicationRepository.getAllByCandidateAndEnrollmentId(candidateId, enrollment.id);\n        if (applications.length === 0) throw new ResourceNotFoundError('Applications not found.');\n\n        await this.validateProfilesExist(submissions);\n        this.assignPriorities(submissions);\n\n        await this.tx(async t => {\n            for (const application of applications) {\n                await this.applicationRepository.delete(application.profileId, application.candidateId, t);\n            }\n            for (const submission of submissions) {\n                const newApplication = this.createApplicationEntity(submission, candidateId, enrollment.id);\n                await this.applicationRepository.insert(newApplication, t);\n            }\n        });\n    }\n\n    private createApplicationEntity(submission: ApplicationRequest, candidateId: number, enrollmentId: number): ApplicationEntity {\n        return {\n            id: 0,\n            candidateId,\n            profileId: submission.profileId,\n            priority: submission.priority,\n            enrollmentId,\n            status: ApplicationStatus.Pending,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n        };\n    }\n\n    private async validateProfilesExist(submissions: ApplicationRequest[]) {\n        for (const submission of submissions) {\n            await this.profileService.getProfile(submission.profileId);\n        }\n    }\n\n    private assignPriorities(submissions: ApplicationRequest[]) {\n        submissions = submissions.sort(\n            (a, b) => a.priority - b.priority\n        );\n\n        submissions.forEach((item, index) => {\n            item.priority = index + 1;\n        });\n    }\n\n    private groupApplicationsBySchool(applications: ApplicationWithProfiles[]) {\n        const groupedBySchool: ApplicationBySchool[] = [];\n        for (const app of applications) {\n            let schoolGroup = groupedBySchool.find(group =>\n                group.school.id === app.school.id\n            );\n            if (!schoolGroup) {\n                schoolGroup = {\n                    school: app.school,\n                    profiles: [],\n                };\n                groupedBySchool.push(schoolGroup);\n            }\n\n            schoolGroup.profiles.push({\n                profileId: app.profile.id,\n                priority: app.priority,\n            });\n        }\n        return groupedBySchool;\n    };\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"da3ee6685db67d08abed52fc6fbc5c9a77c2f744","contentHash":"0289fabb35ee817c3fb10a53e7395d0136d7a11feb74a00de0cf07f21172f065"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/validationError.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/validationError.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":33}},"2":{"start":{"line":4,"column":22},"end":{"line":4,"column":46}},"3":{"start":{"line":7,"column":8},"end":{"line":7,"column":28}},"4":{"start":{"line":8,"column":8},"end":{"line":8,"column":29}},"5":{"start":{"line":11,"column":0},"end":{"line":11,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":38},"end":{"line":9,"column":5}},"line":6}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":25},"end":{"line":6,"column":36}},"type":"default-arg","locations":[{"start":{"line":6,"column":34},"end":{"line":6,"column":36}}],"line":6}},"s":{"0":1,"1":1,"2":1,"3":0,"4":0,"5":1},"f":{"0":0},"b":{"0":[0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/validationError.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/validationError.ts"],"names":[],"mappings":";;;AAAA,+CAA0C;AAG1C,MAAa,eAAgB,SAAQ,yBAAW;IAG5C,YAAY,OAAe,EAAE,SAAmC,EAAE;QAC9D,KAAK,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;QACpB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACzB,CAAC;CACJ;AAPD,0CAOC","sourcesContent":["import {CustomError} from \"./customError\";\nimport {ValidationError as ExpressValidationError} from \"express-validator\";\n\nexport class ValidationError extends CustomError {\n    public errors: ExpressValidationError[];\n\n    constructor(message: string, errors: ExpressValidationError[] = []) {\n        super(message, 400);\n        this.errors = errors;\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5166a20d494925513d228fbed219d50284a1a392","contentHash":"c7c1ce7fdadf8c780bb77263050a83823592133a8d8995b207a85d29c817185e"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/schoolService.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/schoolService.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":31}},"14":{"start":{"line":13,"column":32},"end":{"line":13,"column":74}},"15":{"start":{"line":16,"column":8},"end":{"line":16,"column":49}},"16":{"start":{"line":17,"column":8},"end":{"line":17,"column":45}},"17":{"start":{"line":20,"column":8},"end":{"line":31,"column":11}},"18":{"start":{"line":21,"column":26},"end":{"line":21,"column":62}},"19":{"start":{"line":22,"column":38},"end":{"line":22,"column":40}},"20":{"start":{"line":23,"column":12},"end":{"line":29,"column":13}},"21":{"start":{"line":24,"column":16},"end":{"line":28,"column":19}},"22":{"start":{"line":30,"column":12},"end":{"line":30,"column":39}},"23":{"start":{"line":34,"column":8},"end":{"line":43,"column":11}},"24":{"start":{"line":35,"column":27},"end":{"line":35,"column":66}},"25":{"start":{"line":36,"column":12},"end":{"line":37,"column":93}},"26":{"start":{"line":37,"column":16},"end":{"line":37,"column":93}},"27":{"start":{"line":38,"column":12},"end":{"line":42,"column":14}},"28":{"start":{"line":46,"column":8},"end":{"line":52,"column":11}},"29":{"start":{"line":47,"column":30},"end":{"line":50,"column":13}},"30":{"start":{"line":51,"column":12},"end":{"line":51,"column":58}},"31":{"start":{"line":55,"column":0},"end":{"line":55,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":50},"end":{"line":18,"column":5}},"line":15},"8":{"name":"(anonymous_8)","decl":{"start":{"line":19,"column":4},"end":{"line":19,"column":5}},"loc":{"start":{"line":19,"column":32},"end":{"line":32,"column":5}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":20,"column":47},"end":{"line":20,"column":48}},"loc":{"start":{"line":20,"column":60},"end":{"line":31,"column":9}},"line":20},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":4},"end":{"line":33,"column":5}},"loc":{"start":{"line":33,"column":30},"end":{"line":44,"column":5}},"line":33},"11":{"name":"(anonymous_11)","decl":{"start":{"line":34,"column":47},"end":{"line":34,"column":48}},"loc":{"start":{"line":34,"column":60},"end":{"line":43,"column":9}},"line":34},"12":{"name":"(anonymous_12)","decl":{"start":{"line":45,"column":4},"end":{"line":45,"column":5}},"loc":{"start":{"line":45,"column":20},"end":{"line":53,"column":5}},"line":45},"13":{"name":"(anonymous_13)","decl":{"start":{"line":46,"column":47},"end":{"line":46,"column":48}},"loc":{"start":{"line":46,"column":60},"end":{"line":52,"column":9}},"line":46}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":36,"column":12},"end":{"line":37,"column":93}},"type":"if","locations":[{"start":{"line":36,"column":12},"end":{"line":37,"column":93}},{"start":{},"end":{}}],"line":36}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/schoolService.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/schoolService.ts"],"names":[],"mappings":";;;;;;;;;;;;AAIA,2EAAsE;AAEtE,MAAa,aAAa;IACtB,YACY,gBAAkC,EAClC,cAA8B;QAD9B,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,mBAAc,GAAd,cAAc,CAAgB;IAAG,CAAC;IAExC,yBAAyB;;YAC3B,IAAI,OAAO,GAAmB,MAAM,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,CAAC;YACnE,IAAI,mBAAmB,GAAyB,EAAE,CAAC;YACnD,KAAK,IAAI,MAAM,IAAI,OAAO,EAAE,CAAC;gBACzB,mBAAmB,CAAC,IAAI,CAAC;oBACrB,EAAE,EAAE,MAAM,CAAC,EAAE;oBACb,IAAI,EAAE,MAAM,CAAC,IAAI;oBACjB,QAAQ,EAAE,MAAM,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,MAAM,CAAC,EAAE,CAAC;iBACrE,CAAC,CAAC;YACP,CAAC;YACD,OAAO,mBAAmB,CAAA;QAC9B,CAAC;KAAA;IAEK,qBAAqB,CAAC,EAAU;;YAClC,MAAM,MAAM,GAAwB,MAAM,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YAE5E,IAAI,CAAC,MAAM;gBAAE,MAAM,IAAI,6CAAqB,CAAC,mBAAmB,CAAC,CAAC;YAElE,OAAO;gBACH,EAAE,EAAE,MAAM,CAAC,EAAE;gBACb,IAAI,EAAE,MAAM,CAAC,IAAI;gBACjB,QAAQ,EAAE,MAAM,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,MAAM,CAAC,EAAE,CAAC;aACrE,CAAA;QACL,CAAC;KAAA;IAEK,SAAS,CAAC,IAAY;;YACxB,MAAM,SAAS,GAAiB;gBAC5B,EAAE,EAAE,CAAC;gBACL,IAAI,EAAE,IAAI;aACb,CAAA;YAED,MAAM,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QAClD,CAAC;KAAA;CACJ;AAtCD,sCAsCC","sourcesContent":["import {SchoolRepository} from \"../repositories/schoolRepository\";\nimport {ProfileService} from \"./profileService\";\nimport {SchoolWithProfiles} from \"../dto/schoolWithProfiles\";\nimport {SchoolEntity} from \"../models/schoolEntity\";\nimport {ResourceNotFoundError} from \"../errors/resourceNotFoundError\";\n\nexport class SchoolService {\n    constructor(\n        private schoolRepository: SchoolRepository,\n        private profileService: ProfileService) {}\n\n    async getAllSchoolsWithProfiles(): Promise<SchoolWithProfiles[]> {\n        let schools: SchoolEntity[] = await this.schoolRepository.getAll();\n        let schoolsWithProfiles: SchoolWithProfiles[] = [];\n        for (let school of schools) {\n            schoolsWithProfiles.push({\n                id: school.id,\n                name: school.name,\n                profiles: await this.profileService.getProfilesBySchool(school.id),\n            });\n        }\n        return schoolsWithProfiles\n    }\n\n    async getSchoolWithProfiles(id: number): Promise<SchoolWithProfiles> {\n        const school: SchoolEntity | null = await this.schoolRepository.getById(id);\n\n        if (!school) throw new ResourceNotFoundError('School not found.');\n\n        return {\n            id: school.id,\n            name: school.name,\n            profiles: await this.profileService.getProfilesBySchool(school.id),\n        }\n    }\n\n    async addSchool(name: string,): Promise<void> {\n        const newSchool: SchoolEntity = {\n            id: 0,\n            name: name,\n        }\n\n        await this.schoolRepository.insert(newSchool);\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"65818bc1a9a9574aea028377882991e911a468a7","contentHash":"7f9b246eeb9ea9f299b1540b474b1dce4615d3a10915de769298d9893f430aa4"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/applicationRepository.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/applicationRepository.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":39}},"14":{"start":{"line":13,"column":13},"end":{"line":13,"column":29}},"15":{"start":{"line":14,"column":28},"end":{"line":14,"column":63}},"16":{"start":{"line":17,"column":8},"end":{"line":34,"column":11}},"17":{"start":{"line":18,"column":26},"end":{"line":32,"column":9}},"18":{"start":{"line":33,"column":12},"end":{"line":33,"column":75}},"19":{"start":{"line":37,"column":8},"end":{"line":54,"column":11}},"20":{"start":{"line":38,"column":26},"end":{"line":52,"column":9}},"21":{"start":{"line":53,"column":12},"end":{"line":53,"column":61}},"22":{"start":{"line":57,"column":8},"end":{"line":64,"column":11}},"23":{"start":{"line":58,"column":26},"end":{"line":62,"column":9}},"24":{"start":{"line":63,"column":12},"end":{"line":63,"column":46}},"25":{"start":{"line":67,"column":8},"end":{"line":75,"column":11}},"26":{"start":{"line":68,"column":26},"end":{"line":73,"column":9}},"27":{"start":{"line":74,"column":12},"end":{"line":74,"column":60}},"28":{"start":{"line":78,"column":8},"end":{"line":88,"column":11}},"29":{"start":{"line":79,"column":27},"end":{"line":79,"column":72}},"30":{"start":{"line":80,"column":26},"end":{"line":86,"column":9}},"31":{"start":{"line":87,"column":12},"end":{"line":87,"column":71}},"32":{"start":{"line":91,"column":8},"end":{"line":100,"column":11}},"33":{"start":{"line":92,"column":27},"end":{"line":92,"column":73}},"34":{"start":{"line":93,"column":26},"end":{"line":98,"column":9}},"35":{"start":{"line":99,"column":12},"end":{"line":99,"column":86}},"36":{"start":{"line":103,"column":8},"end":{"line":109,"column":11}},"37":{"start":{"line":104,"column":26},"end":{"line":107,"column":9}},"38":{"start":{"line":108,"column":12},"end":{"line":108,"column":125}},"39":{"start":{"line":112,"column":8},"end":{"line":120,"column":11}},"40":{"start":{"line":113,"column":26},"end":{"line":118,"column":9}},"41":{"start":{"line":119,"column":12},"end":{"line":119,"column":58}},"42":{"start":{"line":123,"column":0},"end":{"line":123,"column":54}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":16,"column":4},"end":{"line":16,"column":5}},"loc":{"start":{"line":16,"column":64},"end":{"line":35,"column":5}},"line":16},"8":{"name":"(anonymous_8)","decl":{"start":{"line":17,"column":47},"end":{"line":17,"column":48}},"loc":{"start":{"line":17,"column":60},"end":{"line":34,"column":9}},"line":17},"9":{"name":"(anonymous_9)","decl":{"start":{"line":36,"column":4},"end":{"line":36,"column":5}},"loc":{"start":{"line":36,"column":35},"end":{"line":55,"column":5}},"line":36},"10":{"name":"(anonymous_10)","decl":{"start":{"line":37,"column":47},"end":{"line":37,"column":48}},"loc":{"start":{"line":37,"column":60},"end":{"line":54,"column":9}},"line":37},"11":{"name":"(anonymous_11)","decl":{"start":{"line":56,"column":4},"end":{"line":56,"column":5}},"loc":{"start":{"line":56,"column":32},"end":{"line":65,"column":5}},"line":56},"12":{"name":"(anonymous_12)","decl":{"start":{"line":57,"column":47},"end":{"line":57,"column":48}},"loc":{"start":{"line":57,"column":60},"end":{"line":64,"column":9}},"line":57},"13":{"name":"(anonymous_13)","decl":{"start":{"line":66,"column":4},"end":{"line":66,"column":5}},"loc":{"start":{"line":66,"column":21},"end":{"line":76,"column":5}},"line":66},"14":{"name":"(anonymous_14)","decl":{"start":{"line":67,"column":47},"end":{"line":67,"column":48}},"loc":{"start":{"line":67,"column":60},"end":{"line":75,"column":9}},"line":67},"15":{"name":"(anonymous_15)","decl":{"start":{"line":77,"column":4},"end":{"line":77,"column":5}},"loc":{"start":{"line":77,"column":59},"end":{"line":89,"column":5}},"line":77},"16":{"name":"(anonymous_16)","decl":{"start":{"line":78,"column":47},"end":{"line":78,"column":48}},"loc":{"start":{"line":78,"column":60},"end":{"line":88,"column":9}},"line":78},"17":{"name":"(anonymous_17)","decl":{"start":{"line":90,"column":4},"end":{"line":90,"column":5}},"loc":{"start":{"line":90,"column":36},"end":{"line":101,"column":5}},"line":90},"18":{"name":"(anonymous_18)","decl":{"start":{"line":91,"column":47},"end":{"line":91,"column":48}},"loc":{"start":{"line":91,"column":60},"end":{"line":100,"column":9}},"line":91},"19":{"name":"(anonymous_19)","decl":{"start":{"line":102,"column":4},"end":{"line":102,"column":5}},"loc":{"start":{"line":102,"column":22},"end":{"line":110,"column":5}},"line":102},"20":{"name":"(anonymous_20)","decl":{"start":{"line":103,"column":47},"end":{"line":103,"column":48}},"loc":{"start":{"line":103,"column":60},"end":{"line":109,"column":9}},"line":103},"21":{"name":"(anonymous_21)","decl":{"start":{"line":111,"column":4},"end":{"line":111,"column":5}},"loc":{"start":{"line":111,"column":38},"end":{"line":121,"column":5}},"line":111},"22":{"name":"(anonymous_22)","decl":{"start":{"line":112,"column":47},"end":{"line":112,"column":48}},"loc":{"start":{"line":112,"column":60},"end":{"line":120,"column":9}},"line":112}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/applicationRepository.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/applicationRepository.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,8BAAgC;AAEhC,gEAA2D;AAE3D,MAAa,qBAAqB;IAExB,gCAAgC,CAAC,WAAmB,EAAE,YAAoB;;YAC5E,MAAM,KAAK,GAAG;;;;;;;;;;;;;;SAcb,CAAC;YAEF,OAAO,MAAM,OAAE,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC,CAAC;QAC9D,CAAC;KAAA;IAEK,iBAAiB,CAAC,WAAmB;;YACvC,MAAM,KAAK,GAAG;;;;;;;;;;;;;;SAcb,CAAC;YAEF,OAAO,MAAM,OAAE,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;QAChD,CAAC;KAAA;IAEK,YAAY,CAAC,EAAU,EAAE,MAAc,EAAE,CAAa;;YACxD,MAAM,KAAK,GAAG;;;;SAIb,CAAC;YAEF,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,CAAC;QACtC,CAAC;KAAA;IAEK,cAAc;;YAChB,MAAM,KAAK,GAAG;;;;;SAKb,CAAC;YAEF,OAAO,CAAC,MAAM,OAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;QAC/C,CAAC;KAAA;IAEK,iCAAiC,CAAC,SAAiB,EAAE,QAAgB;;YACvE,MAAM,MAAM,GAAG,qCAAiB,CAAC,OAAO,CAAC;YACzC,MAAM,KAAK,GAAG;;;;;;SAMb,CAAC;YAEF,OAAO,OAAE,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,SAAS,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC,CAAC;QAC1D,CAAC;KAAA;IAEK,oBAAoB,CAAC,SAAiB;;YACxC,MAAM,MAAM,GAAG,qCAAiB,CAAC,QAAQ,CAAA;YACzC,MAAM,KAAK,GAAG;;;;;SAKb,CAAC;YAEF,OAAO,MAAM,CAAC,CAAC,MAAM,OAAE,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;QACzE,CAAC;KAAA;IAEK,MAAM,CAAC,MAAyB,EAAE,CAAa;;YACjD,MAAM,KAAK,GAAG;;;SAGb,CAAC;YAEF,MAAM,CAAC,CAAC,IAAI,CACR,KAAK,EACL,CAAC,MAAM,CAAC,WAAW,EAAE,MAAM,CAAC,SAAS,EAAE,MAAM,CAAC,QAAQ,EAAE,MAAM,CAAC,YAAY,EAAE,MAAM,CAAC,MAAM,CAAC,CAC9F,CAAC;QACN,CAAC;KAAA;IAEK,MAAM,CAAC,SAAiB,EAAE,WAAmB,EAAE,CAAa;;YAC9D,MAAM,KAAK,GAAG;;;;;SAKb,CAAC;YAEF,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC,CAAC;QAClD,CAAC;KAAA;CACJ;AA9GD,sDA8GC","sourcesContent":["import {db, ITask} from '../db';\nimport {ApplicationEntity} from \"../models/applicationEntity\";\nimport {ApplicationStatus} from \"../dto/applicationStatus\";\n\nexport class ApplicationRepository {\n\n    async getAllByCandidateAndEnrollmentId(candidateId: number, enrollmentId: number): Promise<ApplicationEntity[]> {\n        const query = `\n            SELECT a.candidate_id as candidate_id,\n                   p.id           AS profile_id,\n                   s.id           AS school_id,\n                   a.priority,\n                   a.status,\n                   a.enrollment_id,\n                   a.created_at,\n                   a.updated_at\n            FROM applications a\n                     JOIN profiles p ON a.profile_id = p.id\n                     JOIN schools s ON p.school_id = s.id\n            WHERE candidate_id = $1\n              and enrollment_id = $2\n        `;\n\n        return await db.query(query, [candidateId, enrollmentId]);\n    }\n\n    async getAllByCandidate(candidateId: number): Promise<ApplicationEntity[]> {\n        const query = `\n            SELECT a.id,\n                   a.candidate_id,\n                   p.id AS profile_id,\n                   s.id AS school_id,\n                   a.priority,\n                   a.status,\n                   a.enrollment_id,\n                   a.created_at,\n                   a.updated_at\n            FROM applications a\n                     JOIN profiles p ON a.profile_id = p.id\n                     JOIN schools s ON p.school_id = s.id\n            WHERE candidate_id = $1\n        `;\n\n        return await db.query(query, [candidateId]);\n    }\n\n    async updateStatus(id: number, status: string, t: ITask<any>): Promise<void> {\n        const query = `\n            UPDATE applications\n            SET status = $2\n            WHERE id = $1\n        `;\n\n        await t.none(query, [id, status]);\n    }\n\n    async getMaxPriority(): Promise<number> {\n        const query = `\n            SELECT priority\n            FROM applications\n            ORDER BY priority DESC\n            LIMIT 1;\n        `;\n\n        return (await db.query(query))[0].priority;\n    }\n\n    async getAllPendingByProfileAndPriority(profileId: number, priority: number): Promise<ApplicationEntity[]> {\n        const status = ApplicationStatus.Pending;\n        const query = `\n            SELECT *\n            FROM applications\n            WHERE profile_id = $1\n              and priority = $2\n              and status = $3\n        `;\n\n        return db.query(query, [profileId, priority, status]);\n    }\n\n    async getEnrolledByProfile(profileId: number): Promise<number> {\n        const status = ApplicationStatus.Accepted\n        const query = `\n            SELECT COUNT(*)\n            FROM applications\n            WHERE profile_id = $1\n              and status = $2\n        `;\n\n        return Number((await db.query(query, [profileId, status]))[0].count);\n    }\n\n    async insert(newApp: ApplicationEntity, t: ITask<any>): Promise<void> {\n        const query = `\n            INSERT INTO applications (candidate_id, profile_id, priority, enrollment_id, status)\n            VALUES ($1, $2, $3, $4, $5)\n        `;\n\n        await t.none(\n            query,\n            [newApp.candidateId, newApp.profileId, newApp.priority, newApp.enrollmentId, newApp.status]\n        );\n    }\n\n    async delete(profileId: number, candidateId: number, t: ITask<any>): Promise<void> {\n        const query = `\n            DELETE\n            FROM applications\n            WHERE profile_id = $1\n              AND candidate_id = $2\n        `;\n\n        await t.none(query, [profileId, candidateId]);\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2667787f638f1e6fa1bcc4604603c2b4213f6ca9","contentHash":"8169389d40437b37b2b4dcf6ade7b1f7e0e5dd3b75aefb9b0ab680d744a27988"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/db.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/db.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":33}},"16":{"start":{"line":16,"column":21},"end":{"line":16,"column":59}},"17":{"start":{"line":17,"column":17},"end":{"line":17,"column":51}},"18":{"start":{"line":18,"column":0},"end":{"line":18,"column":26}},"19":{"start":{"line":19,"column":12},"end":{"line":23,"column":2}},"20":{"start":{"line":21,"column":8},"end":{"line":21,"column":32}},"21":{"start":{"line":25,"column":16},"end":{"line":25,"column":23}},"22":{"start":{"line":26,"column":4},"end":{"line":35,"column":5}},"23":{"start":{"line":27,"column":22},"end":{"line":27,"column":46}},"24":{"start":{"line":28,"column":8},"end":{"line":34,"column":9}},"25":{"start":{"line":29,"column":12},"end":{"line":33,"column":13}},"26":{"start":{"line":29,"column":25},"end":{"line":29,"column":26}},"27":{"start":{"line":30,"column":26},"end":{"line":30,"column":33}},"28":{"start":{"line":31,"column":16},"end":{"line":31,"column":35}},"29":{"start":{"line":32,"column":16},"end":{"line":32,"column":31}},"30":{"start":{"line":37,"column":11},"end":{"line":43,"column":2}},"31":{"start":{"line":44,"column":0},"end":{"line":44,"column":16}},"32":{"start":{"line":45,"column":11},"end":{"line":47,"column":2}},"33":{"start":{"line":45,"column":25},"end":{"line":47,"column":2}},"34":{"start":{"line":46,"column":4},"end":{"line":46,"column":27}},"35":{"start":{"line":48,"column":0},"end":{"line":48,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":20,"column":4},"end":{"line":20,"column":5}},"loc":{"start":{"line":20,"column":15},"end":{"line":22,"column":5}},"line":20},"9":{"name":"camelizeColumns","decl":{"start":{"line":24,"column":9},"end":{"line":24,"column":24}},"loc":{"start":{"line":24,"column":31},"end":{"line":36,"column":1}},"line":24},"10":{"name":"(anonymous_10)","decl":{"start":{"line":45,"column":11},"end":{"line":45,"column":12}},"loc":{"start":{"line":45,"column":25},"end":{"line":47,"column":2}},"line":45},"11":{"name":"(anonymous_11)","decl":{"start":{"line":45,"column":59},"end":{"line":45,"column":60}},"loc":{"start":{"line":45,"column":72},"end":{"line":47,"column":1}},"line":45}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":28,"column":8},"end":{"line":34,"column":9}},"type":"if","locations":[{"start":{"line":28,"column":8},"end":{"line":34,"column":9}},{"start":{},"end":{}}],"line":28},"9":{"loc":{"start":{"line":39,"column":10},"end":{"line":39,"column":72}},"type":"cond-expr","locations":[{"start":{"line":39,"column":32},"end":{"line":39,"column":65}},{"start":{"line":39,"column":68},"end":{"line":39,"column":72}}],"line":39}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":1,"32":1,"33":0,"34":0,"35":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":2,"8":0,"9":0,"10":0,"11":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[0,0],"9":[1,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/db.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/db.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,4DAA4C;AAC5C,oDAA4B;AAE5B,gBAAM,CAAC,MAAM,EAAE,CAAC;AAEhB,MAAM,GAAG,GAAG,IAAA,oBAAS,EAAC;IAClB,OAAO,CAAC,CAAC;QACL,eAAe,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;IAC5B,CAAC;CACJ,CAAC,CAAC;AAEH,SAAS,eAAe,CAAC,IAAW;IAChC,MAAM,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;IACpB,KAAK,MAAM,IAAI,IAAI,GAAG,EAAE,CAAC;QACrB,MAAM,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;QACvC,IAAI,CAAC,CAAC,KAAK,IAAI,GAAG,CAAC,EAAE,CAAC;YAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;gBACnC,MAAM,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;gBAClB,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC;gBACnB,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC;YACnB,CAAC;QACL,CAAC;IACL,CAAC;AACL,CAAC;AAGD,MAAM,EAAE,GAAG,GAAG,CAAC;IACX,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO;IACzB,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI;IACpE,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO;IAC7B,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO;IACzB,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,WAAW;CACpC,CAAC,CAAC;AAQK,gBAAE;AAJV,MAAM,EAAE,GAAwB,CAAO,QAAQ,EAAE,EAAE;IAC/C,OAAO,EAAE,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC;AAC3B,CAAC,CAAA,CAAC;AAEU,gBAAE","sourcesContent":["import pgPromise, {ITask} from 'pg-promise';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nconst pgp = pgPromise({\n    receive(e) {\n        camelizeColumns(e.data);\n    }\n});\n\nfunction camelizeColumns(data: any[]) {\n    const tmp = data[0];\n    for (const prop in tmp) {\n        const camel = pgp.utils.camelize(prop);\n        if (!(camel in tmp)) {\n            for (let i = 0; i < data.length; i++) {\n                const d = data[i];\n                d[camel] = d[prop];\n                delete d[prop];\n            }\n        }\n    }\n}\n\n\nconst db = pgp({\n    host: process.env.DB_HOST,\n    port: process.env.DB_PORT ? parseInt(process.env.DB_PORT, 10) : 5432,\n    database: process.env.DB_NAME,\n    user: process.env.DB_USER,\n    password: process.env.DB_PASSWORD,\n});\n\ntype transactionFunction = (callback: (t: ITask<any>) => Promise<void>) => Promise<void>;\n\nconst tx: transactionFunction = async (callback) => {\n    return db.tx(callback);\n};\n\nexport {db, tx, transactionFunction, ITask};"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"376f54613f21513f561e3f845fe8c0d33575183d","contentHash":"95af5215f3dbf1d1b878ebc84394fab29543d0234fb084faa907014332345555"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/enrollmentService.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/enrollmentService.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":35}},"14":{"start":{"line":13,"column":32},"end":{"line":13,"column":74}},"15":{"start":{"line":16,"column":8},"end":{"line":16,"column":57}},"16":{"start":{"line":19,"column":8},"end":{"line":24,"column":11}},"17":{"start":{"line":20,"column":31},"end":{"line":20,"column":74}},"18":{"start":{"line":21,"column":12},"end":{"line":22,"column":97}},"19":{"start":{"line":22,"column":16},"end":{"line":22,"column":97}},"20":{"start":{"line":23,"column":12},"end":{"line":23,"column":30}},"21":{"start":{"line":27,"column":8},"end":{"line":29,"column":11}},"22":{"start":{"line":28,"column":12},"end":{"line":28,"column":58}},"23":{"start":{"line":32,"column":8},"end":{"line":34,"column":11}},"24":{"start":{"line":33,"column":12},"end":{"line":33,"column":69}},"25":{"start":{"line":37,"column":0},"end":{"line":37,"column":46}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":38},"end":{"line":17,"column":5}},"line":15},"8":{"name":"(anonymous_8)","decl":{"start":{"line":18,"column":4},"end":{"line":18,"column":5}},"loc":{"start":{"line":18,"column":22},"end":{"line":25,"column":5}},"line":18},"9":{"name":"(anonymous_9)","decl":{"start":{"line":19,"column":47},"end":{"line":19,"column":48}},"loc":{"start":{"line":19,"column":60},"end":{"line":24,"column":9}},"line":19},"10":{"name":"(anonymous_10)","decl":{"start":{"line":26,"column":4},"end":{"line":26,"column":5}},"loc":{"start":{"line":26,"column":27},"end":{"line":30,"column":5}},"line":26},"11":{"name":"(anonymous_11)","decl":{"start":{"line":27,"column":47},"end":{"line":27,"column":48}},"loc":{"start":{"line":27,"column":60},"end":{"line":29,"column":9}},"line":27},"12":{"name":"(anonymous_12)","decl":{"start":{"line":31,"column":4},"end":{"line":31,"column":5}},"loc":{"start":{"line":31,"column":32},"end":{"line":35,"column":5}},"line":31},"13":{"name":"(anonymous_13)","decl":{"start":{"line":32,"column":47},"end":{"line":32,"column":48}},"loc":{"start":{"line":32,"column":60},"end":{"line":34,"column":9}},"line":32}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":21,"column":12},"end":{"line":22,"column":97}},"type":"if","locations":[{"start":{"line":21,"column":12},"end":{"line":22,"column":97}},{"start":{},"end":{}}],"line":21}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/enrollmentService.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/enrollmentService.ts"],"names":[],"mappings":";;;;;;;;;;;;AACA,2EAAsE;AAGtE,MAAa,iBAAiB;IAC1B,YAAqB,oBAA0C;QAA1C,yBAAoB,GAApB,oBAAoB,CAAsB;IAAG,CAAC;IAE7D,aAAa,CAAC,EAAU;;YAC1B,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YAC/D,IAAI,CAAC,UAAU;gBAAE,MAAM,IAAI,6CAAqB,CAAC,uBAAuB,CAAC,CAAC;YAC1E,OAAO,UAAU,CAAC;QACtB,CAAC;KAAA;IAEK,oBAAoB;;YACtB,OAAO,IAAI,CAAC,oBAAoB,CAAC,UAAU,EAAE,CAAC;QAClD,CAAC;KAAA;IAEK,yBAAyB;;YAC3B,OAAO,IAAI,CAAC,oBAAoB,CAAC,qBAAqB,EAAE,CAAC;QAC7D,CAAC;KAAA;CACJ;AAhBD,8CAgBC","sourcesContent":["import {EnrollmentRepository} from \"../repositories/enrollmentRepository\";\nimport {ResourceNotFoundError} from \"../errors/resourceNotFoundError\";\nimport {Enrollment} from \"../dto/enrollment\";\n\nexport class EnrollmentService {\n    constructor (private enrollmentRepository: EnrollmentRepository) {}\n\n    async getEnrollment(id: number): Promise<Enrollment> {\n        const enrollment = await this.enrollmentRepository.getById(id);\n        if (!enrollment) throw new ResourceNotFoundError('Enrollment not found.');\n        return enrollment;\n    }\n\n    async getCurrentEnrollment(): Promise<Enrollment | null> {\n        return this.enrollmentRepository.getCurrent();\n    }\n\n    async getCurrentYearEnrollments(): Promise<Enrollment[]> {\n        return this.enrollmentRepository.getAllFromCurrentYear();\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"520516417badceac1a335084a46db8a01e0425da","contentHash":"2e15aec6a7a60b6b9d0158a6fae8d3bd397e052dc8b7a4496bd5824b80dd4da3"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/candidateRepository.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/candidateRepository.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":37}},"14":{"start":{"line":13,"column":13},"end":{"line":13,"column":29}},"15":{"start":{"line":16,"column":8},"end":{"line":23,"column":11}},"16":{"start":{"line":17,"column":26},"end":{"line":21,"column":9}},"17":{"start":{"line":22,"column":12},"end":{"line":22,"column":50}},"18":{"start":{"line":26,"column":8},"end":{"line":32,"column":11}},"19":{"start":{"line":27,"column":26},"end":{"line":30,"column":9}},"20":{"start":{"line":31,"column":12},"end":{"line":31,"column":45}},"21":{"start":{"line":35,"column":8},"end":{"line":41,"column":11}},"22":{"start":{"line":36,"column":26},"end":{"line":39,"column":9}},"23":{"start":{"line":40,"column":12},"end":{"line":40,"column":40}},"24":{"start":{"line":44,"column":8},"end":{"line":51,"column":11}},"25":{"start":{"line":45,"column":26},"end":{"line":49,"column":9}},"26":{"start":{"line":50,"column":12},"end":{"line":50,"column":53}},"27":{"start":{"line":54,"column":8},"end":{"line":60,"column":11}},"28":{"start":{"line":55,"column":26},"end":{"line":58,"column":9}},"29":{"start":{"line":59,"column":12},"end":{"line":59,"column":50}},"30":{"start":{"line":63,"column":8},"end":{"line":71,"column":11}},"31":{"start":{"line":64,"column":26},"end":{"line":69,"column":9}},"32":{"start":{"line":70,"column":12},"end":{"line":70,"column":54}},"33":{"start":{"line":74,"column":8},"end":{"line":82,"column":11}},"34":{"start":{"line":75,"column":26},"end":{"line":79,"column":9}},"35":{"start":{"line":80,"column":27},"end":{"line":80,"column":115}},"36":{"start":{"line":81,"column":12},"end":{"line":81,"column":46}},"37":{"start":{"line":85,"column":0},"end":{"line":85,"column":50}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":16},"end":{"line":24,"column":5}},"line":15},"8":{"name":"(anonymous_8)","decl":{"start":{"line":16,"column":47},"end":{"line":16,"column":48}},"loc":{"start":{"line":16,"column":60},"end":{"line":23,"column":9}},"line":16},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":4},"end":{"line":25,"column":5}},"loc":{"start":{"line":25,"column":19},"end":{"line":33,"column":5}},"line":25},"10":{"name":"(anonymous_10)","decl":{"start":{"line":26,"column":47},"end":{"line":26,"column":48}},"loc":{"start":{"line":26,"column":60},"end":{"line":32,"column":9}},"line":26},"11":{"name":"(anonymous_11)","decl":{"start":{"line":34,"column":4},"end":{"line":34,"column":5}},"loc":{"start":{"line":34,"column":13},"end":{"line":42,"column":5}},"line":34},"12":{"name":"(anonymous_12)","decl":{"start":{"line":35,"column":47},"end":{"line":35,"column":48}},"loc":{"start":{"line":35,"column":60},"end":{"line":41,"column":9}},"line":35},"13":{"name":"(anonymous_13)","decl":{"start":{"line":43,"column":4},"end":{"line":43,"column":5}},"loc":{"start":{"line":43,"column":22},"end":{"line":52,"column":5}},"line":43},"14":{"name":"(anonymous_14)","decl":{"start":{"line":44,"column":47},"end":{"line":44,"column":48}},"loc":{"start":{"line":44,"column":60},"end":{"line":51,"column":9}},"line":44},"15":{"name":"(anonymous_15)","decl":{"start":{"line":53,"column":4},"end":{"line":53,"column":5}},"loc":{"start":{"line":53,"column":25},"end":{"line":61,"column":5}},"line":53},"16":{"name":"(anonymous_16)","decl":{"start":{"line":54,"column":47},"end":{"line":54,"column":48}},"loc":{"start":{"line":54,"column":60},"end":{"line":60,"column":9}},"line":54},"17":{"name":"(anonymous_17)","decl":{"start":{"line":62,"column":4},"end":{"line":62,"column":5}},"loc":{"start":{"line":62,"column":33},"end":{"line":72,"column":5}},"line":62},"18":{"name":"(anonymous_18)","decl":{"start":{"line":63,"column":47},"end":{"line":63,"column":48}},"loc":{"start":{"line":63,"column":60},"end":{"line":71,"column":9}},"line":63},"19":{"name":"(anonymous_19)","decl":{"start":{"line":73,"column":4},"end":{"line":73,"column":5}},"loc":{"start":{"line":73,"column":25},"end":{"line":83,"column":5}},"line":73},"20":{"name":"(anonymous_20)","decl":{"start":{"line":74,"column":47},"end":{"line":74,"column":48}},"loc":{"start":{"line":74,"column":60},"end":{"line":82,"column":9}},"line":74}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/candidateRepository.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/candidateRepository.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,8BAAyB;AAGzB,MAAa,mBAAmB;IACtB,OAAO,CAAC,EAAU;;YACpB,MAAM,KAAK,GAAG;;;;SAIb,CAAC;YACF,OAAO,OAAE,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QACrC,CAAC;KAAA;IAEK,UAAU,CAAC,EAAU;;YACvB,MAAM,KAAK,GAAG;;;SAGb,CAAC;YACF,MAAM,OAAE,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAChC,CAAC;KAAA;IAEK,MAAM;;YACR,MAAM,KAAK,GAAG;;;SAGb,CAAC;YAEF,OAAO,OAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QAC3B,CAAC;KAAA;IAEK,UAAU,CAAC,KAAa;;YAC1B,MAAM,KAAK,GAAG;;;;SAIb,CAAC;YACF,OAAO,OAAE,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;QACxC,CAAC;KAAA;IAEK,YAAY,CAAC,MAAc;;YAC7B,MAAM,KAAK,GAAG;;;SAGb,CAAA;YAED,OAAO,OAAE,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;QACrC,CAAC;KAAA;IAEK,oBAAoB,CAAC,MAAc;;YACrC,MAAM,KAAK,GAAG;;;;;SAKb,CAAC;YACF,OAAO,OAAE,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;QACzC,CAAC;KAAA;IAEK,MAAM,CAAC,YAA6B;;YACtC,MAAM,KAAK,GAAG;;;;SAIb,CAAC;YAEF,MAAM,MAAM,GAAG,CAAC,YAAY,CAAC,SAAS,EAAE,YAAY,CAAC,QAAQ,EAAE,YAAY,CAAC,KAAK,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;YACxG,OAAO,OAAE,CAAC,GAAG,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;QACjC,CAAC;KAAA;CACJ;AAjED,kDAiEC","sourcesContent":["import {db} from '../db';\nimport {CandidateEntity} from \"../models/candidateEntity\";\n\nexport class CandidateRepository {\n    async getById(id: number): Promise<CandidateEntity | null> {\n        const query = `\n            SELECT * FROM candidates\n            WHERE id = $1\n            LIMIT 1\n        `;\n        return db.oneOrNone(query, [id]);\n    }\n\n    async deleteById(id: number): Promise<void> {\n        const query = `\n            DELETE FROM candidates\n            WHERE id = $1\n        `;\n        await db.query(query, [id]);\n    }\n\n    async getAll(): Promise<CandidateEntity[]> {\n        const query = `\n            SELECT *\n            FROM candidates\n        `;\n\n        return db.query(query);\n    }\n\n    async getByPesel(pesel: string): Promise<CandidateEntity | null> {\n        const query = `\n            SELECT * FROM candidates\n            WHERE pesel = $1\n            LIMIT 1\n        `;\n        return db.oneOrNone(query, [pesel]);\n    }\n\n    async getAllByUser(userId: number): Promise<CandidateEntity[]> {\n        const query = `\n            SELECT * FROM candidates\n            WHERE user_id = $1\n        `\n\n        return db.query(query, [userId]);\n    }\n\n    async getLastUpdatedByUser(userId: number): Promise<CandidateEntity | null> {\n        const query = `\n            SELECT * FROM candidates\n            WHERE user_id = $1\n            ORDER BY updated_at DESC\n            LIMIT 1;\n        `;\n        return db.oneOrNone(query, [userId]);\n    }\n\n    async insert(newCandidate: CandidateEntity): Promise<CandidateEntity> {\n        const query = `\n            INSERT INTO candidates (first_name, last_name, pesel, user_id)\n            VALUES ($1, $2, $3, $4)\n            RETURNING id;\n        `;\n\n        const values = [newCandidate.firstName, newCandidate.lastName, newCandidate.pesel, newCandidate.userId];\n        return db.one(query, values);\n    }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"32e7db229a1a5517cddf3939d8244fd0c8d221b7","contentHash":"345dddb8e6b8414223029a55f4f5733fa4bd516492dc33cc61ba1153c1ac8f61"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/gradeService.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/gradeService.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":30}},"14":{"start":{"line":13,"column":28},"end":{"line":13,"column":66}},"15":{"start":{"line":14,"column":26},"end":{"line":14,"column":62}},"16":{"start":{"line":17,"column":8},"end":{"line":17,"column":47}},"17":{"start":{"line":18,"column":8},"end":{"line":18,"column":45}},"18":{"start":{"line":19,"column":8},"end":{"line":19,"column":21}},"19":{"start":{"line":22,"column":8},"end":{"line":24,"column":11}},"20":{"start":{"line":23,"column":12},"end":{"line":23,"column":71}},"21":{"start":{"line":27,"column":8},"end":{"line":29,"column":11}},"22":{"start":{"line":28,"column":12},"end":{"line":28,"column":78}},"23":{"start":{"line":32,"column":8},"end":{"line":43,"column":11}},"24":{"start":{"line":33,"column":12},"end":{"line":42,"column":16}},"25":{"start":{"line":33,"column":33},"end":{"line":42,"column":14}},"26":{"start":{"line":34,"column":33},"end":{"line":34,"column":75}},"27":{"start":{"line":35,"column":37},"end":{"line":35,"column":74}},"28":{"start":{"line":35,"column":58},"end":{"line":35,"column":73}},"29":{"start":{"line":36,"column":16},"end":{"line":36,"column":98}},"30":{"start":{"line":37,"column":16},"end":{"line":37,"column":66}},"31":{"start":{"line":38,"column":16},"end":{"line":41,"column":17}},"32":{"start":{"line":39,"column":20},"end":{"line":39,"column":75}},"33":{"start":{"line":40,"column":20},"end":{"line":40,"column":71}},"34":{"start":{"line":46,"column":30},"end":{"line":46,"column":61}},"35":{"start":{"line":47,"column":8},"end":{"line":49,"column":9}},"36":{"start":{"line":48,"column":12},"end":{"line":48,"column":83}},"37":{"start":{"line":52,"column":8},"end":{"line":64,"column":9}},"38":{"start":{"line":53,"column":40},"end":{"line":56,"column":14}},"39":{"start":{"line":54,"column":31},"end":{"line":54,"column":57}},"40":{"start":{"line":55,"column":16},"end":{"line":55,"column":58}},"41":{"start":{"line":57,"column":33},"end":{"line":60,"column":14}},"42":{"start":{"line":58,"column":31},"end":{"line":58,"column":57}},"43":{"start":{"line":59,"column":16},"end":{"line":59,"column":51}},"44":{"start":{"line":61,"column":12},"end":{"line":63,"column":13}},"45":{"start":{"line":62,"column":16},"end":{"line":62,"column":123}},"46":{"start":{"line":67,"column":8},"end":{"line":71,"column":11}},"47":{"start":{"line":68,"column":34},"end":{"line":68,"column":138}},"48":{"start":{"line":69,"column":12},"end":{"line":70,"column":88}},"49":{"start":{"line":70,"column":16},"end":{"line":70,"column":88}},"50":{"start":{"line":74,"column":8},"end":{"line":82,"column":11}},"51":{"start":{"line":75,"column":29},"end":{"line":80,"column":13}},"52":{"start":{"line":81,"column":12},"end":{"line":81,"column":59}},"53":{"start":{"line":85,"column":0},"end":{"line":85,"column":36}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":16,"column":4},"end":{"line":16,"column":5}},"loc":{"start":{"line":16,"column":53},"end":{"line":20,"column":5}},"line":16},"8":{"name":"(anonymous_8)","decl":{"start":{"line":21,"column":4},"end":{"line":21,"column":5}},"loc":{"start":{"line":21,"column":35},"end":{"line":25,"column":5}},"line":21},"9":{"name":"(anonymous_9)","decl":{"start":{"line":22,"column":47},"end":{"line":22,"column":48}},"loc":{"start":{"line":22,"column":60},"end":{"line":24,"column":9}},"line":22},"10":{"name":"(anonymous_10)","decl":{"start":{"line":26,"column":4},"end":{"line":26,"column":5}},"loc":{"start":{"line":26,"column":40},"end":{"line":30,"column":5}},"line":26},"11":{"name":"(anonymous_11)","decl":{"start":{"line":27,"column":47},"end":{"line":27,"column":48}},"loc":{"start":{"line":27,"column":60},"end":{"line":29,"column":9}},"line":27},"12":{"name":"(anonymous_12)","decl":{"start":{"line":31,"column":4},"end":{"line":31,"column":5}},"loc":{"start":{"line":31,"column":43},"end":{"line":44,"column":5}},"line":31},"13":{"name":"(anonymous_13)","decl":{"start":{"line":32,"column":47},"end":{"line":32,"column":48}},"loc":{"start":{"line":32,"column":60},"end":{"line":43,"column":9}},"line":32},"14":{"name":"(anonymous_14)","decl":{"start":{"line":33,"column":26},"end":{"line":33,"column":27}},"loc":{"start":{"line":33,"column":33},"end":{"line":42,"column":14}},"line":33},"15":{"name":"(anonymous_15)","decl":{"start":{"line":33,"column":65},"end":{"line":33,"column":66}},"loc":{"start":{"line":33,"column":78},"end":{"line":42,"column":13}},"line":33},"16":{"name":"(anonymous_16)","decl":{"start":{"line":35,"column":53},"end":{"line":35,"column":54}},"loc":{"start":{"line":35,"column":58},"end":{"line":35,"column":73}},"line":35},"17":{"name":"(anonymous_17)","decl":{"start":{"line":45,"column":4},"end":{"line":45,"column":5}},"loc":{"start":{"line":45,"column":72},"end":{"line":50,"column":5}},"line":45},"18":{"name":"(anonymous_18)","decl":{"start":{"line":51,"column":4},"end":{"line":51,"column":5}},"loc":{"start":{"line":51,"column":49},"end":{"line":65,"column":5}},"line":51},"19":{"name":"(anonymous_19)","decl":{"start":{"line":53,"column":57},"end":{"line":53,"column":58}},"loc":{"start":{"line":53,"column":62},"end":{"line":56,"column":13}},"line":53},"20":{"name":"(anonymous_20)","decl":{"start":{"line":57,"column":50},"end":{"line":57,"column":51}},"loc":{"start":{"line":57,"column":55},"end":{"line":60,"column":13}},"line":57},"21":{"name":"(anonymous_21)","decl":{"start":{"line":66,"column":4},"end":{"line":66,"column":5}},"loc":{"start":{"line":66,"column":48},"end":{"line":72,"column":5}},"line":66},"22":{"name":"(anonymous_22)","decl":{"start":{"line":67,"column":47},"end":{"line":67,"column":48}},"loc":{"start":{"line":67,"column":60},"end":{"line":71,"column":9}},"line":67},"23":{"name":"(anonymous_23)","decl":{"start":{"line":73,"column":4},"end":{"line":73,"column":5}},"loc":{"start":{"line":73,"column":44},"end":{"line":83,"column":5}},"line":73},"24":{"name":"(anonymous_24)","decl":{"start":{"line":74,"column":47},"end":{"line":74,"column":48}},"loc":{"start":{"line":74,"column":60},"end":{"line":82,"column":9}},"line":74}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":47,"column":8},"end":{"line":49,"column":9}},"type":"if","locations":[{"start":{"line":47,"column":8},"end":{"line":49,"column":9}},{"start":{},"end":{}}],"line":47},"6":{"loc":{"start":{"line":55,"column":23},"end":{"line":55,"column":57}},"type":"binary-expr","locations":[{"start":{"line":55,"column":23},"end":{"line":55,"column":29}},{"start":{"line":55,"column":33},"end":{"line":55,"column":57}}],"line":55},"7":{"loc":{"start":{"line":59,"column":23},"end":{"line":59,"column":50}},"type":"binary-expr","locations":[{"start":{"line":59,"column":23},"end":{"line":59,"column":29}},{"start":{"line":59,"column":33},"end":{"line":59,"column":50}}],"line":59},"8":{"loc":{"start":{"line":61,"column":12},"end":{"line":63,"column":13}},"type":"if","locations":[{"start":{"line":61,"column":12},"end":{"line":63,"column":13}},{"start":{},"end":{}}],"line":61},"9":{"loc":{"start":{"line":61,"column":16},"end":{"line":61,"column":80}},"type":"binary-expr","locations":[{"start":{"line":61,"column":16},"end":{"line":61,"column":36}},{"start":{"line":61,"column":41},"end":{"line":61,"column":62}},{"start":{"line":61,"column":66},"end":{"line":61,"column":79}}],"line":61},"10":{"loc":{"start":{"line":69,"column":12},"end":{"line":70,"column":88}},"type":"if","locations":[{"start":{"line":69,"column":12},"end":{"line":70,"column":88}},{"start":{},"end":{}}],"line":69}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0,0],"10":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/gradeService.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/gradeService.ts"],"names":[],"mappings":"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","sourcesContent":["import {GradeRepository} from \"../repositories/gradeRepository\";\nimport {DataConflictError} from \"../errors/dataConflictError\";\nimport {ITask} from \"pg-promise\";\nimport {GradeRequest} from \"../dto/gradeRequest\";\nimport {SubjectService} from \"./subjectService\";\nimport {ValidationError} from \"../errors/validationError\";\nimport {GradeEntity} from \"../models/gradeEntity\";\nimport {Grade} from \"../dto/grade\";\nimport {Subject} from \"../dto/subject\";\n\nexport class GradeService {\n    constructor(\n        private gradeRepository: GradeRepository,\n        private subjectService: SubjectService,\n        private readonly tx: (callback: (t: ITask<any>) => Promise<void>) => Promise<void>) {\n    }\n\n    async getAllByCandidate(candidateId: number) {\n        return this.gradeRepository.getAllByCandidate(candidateId);\n    }\n\n    async checkIfGradesSubmitted(candidateId: number): Promise<boolean> {\n        return !!(await this.gradeRepository.getByCandidate(candidateId));\n    }\n\n    async submitGrades(submissions: GradeRequest[], candidateId: number): Promise<void> {\n        await this.tx(async t => {\n            const subjects = await this.subjectService.getAllSubjects();\n            const examSubjects = subjects.filter(s => s.isExamSubject);\n\n            this.validateGradeCount(submissions.length, subjects.length, examSubjects.length);\n            this.validateGradeSubjects(submissions, subjects)\n\n            for (const submission of submissions) {\n                await this.checkIfGradeExists(submission, candidateId);\n                await this.insertGrade(submission, candidateId, t)\n            }\n        });\n    }\n\n    private validateGradeCount(submissionCount: number, subjectCount: number, examSubjectCount: number) {\n        const requiredCount = subjectCount + examSubjectCount;\n        if (submissionCount !== requiredCount) {\n            throw new ValidationError(\"Wrong number of grades.\");\n        }\n    }\n\n    private validateGradeSubjects(submissions: GradeRequest[], subjects: Subject[]) {\n        for (const subject of subjects) {\n            const hasCertificateGrade = submissions.some(s => {\n                const sameId = s.subjectId === subject.id;\n                return sameId && s.type === \"certificate\";\n            });\n\n            const hasExamGrade = submissions.some(s => {\n                const sameId = s.subjectId === subject.id;\n                return sameId && s.type === \"exam\";\n            });\n\n            if (!hasCertificateGrade || (subject.isExamSubject && !hasExamGrade)) {\n                throw new ValidationError(`Grade for subject ${subject.id}: ${subject.name} not found.`);\n            }\n        }\n    }\n\n    private async checkIfGradeExists(submission: GradeRequest, candidateId: number) {\n        const existingGrade: Grade | null = await this.gradeRepository.getByCandidateSubjectType(\n            candidateId,\n            submission.subjectId,\n            submission.type\n        );\n        if (existingGrade) throw new DataConflictError('Grade already exists');\n    }\n\n    private async insertGrade(submission: GradeRequest, candidateId: number, t: ITask<any>) {\n        const newGrade: GradeEntity = {\n            candidateId: candidateId,\n            subjectId: submission.subjectId,\n            grade: submission.grade,\n            type: submission.type,\n        };\n        await this.gradeRepository.insert(newGrade, t);\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fcd84d698861c7ae951eddb508919eec35e42b15","contentHash":"99c0435237e5e823babf8a6c00ceecade71953f5dd0b1ae6d7b3562ee97ab47c"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/enrollmentRepository.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/enrollmentRepository.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":38}},"14":{"start":{"line":13,"column":13},"end":{"line":13,"column":29}},"15":{"start":{"line":16,"column":8},"end":{"line":24,"column":11}},"16":{"start":{"line":17,"column":26},"end":{"line":22,"column":9}},"17":{"start":{"line":23,"column":12},"end":{"line":23,"column":56}},"18":{"start":{"line":27,"column":8},"end":{"line":36,"column":11}},"19":{"start":{"line":28,"column":25},"end":{"line":28,"column":35}},"20":{"start":{"line":29,"column":26},"end":{"line":34,"column":9}},"21":{"start":{"line":35,"column":12},"end":{"line":35,"column":58}},"22":{"start":{"line":39,"column":8},"end":{"line":47,"column":11}},"23":{"start":{"line":40,"column":25},"end":{"line":40,"column":49}},"24":{"start":{"line":41,"column":26},"end":{"line":45,"column":9}},"25":{"start":{"line":46,"column":12},"end":{"line":46,"column":54}},"26":{"start":{"line":50,"column":0},"end":{"line":50,"column":52}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":16},"end":{"line":25,"column":5}},"line":15},"8":{"name":"(anonymous_8)","decl":{"start":{"line":16,"column":47},"end":{"line":16,"column":48}},"loc":{"start":{"line":16,"column":60},"end":{"line":24,"column":9}},"line":16},"9":{"name":"(anonymous_9)","decl":{"start":{"line":26,"column":4},"end":{"line":26,"column":5}},"loc":{"start":{"line":26,"column":17},"end":{"line":37,"column":5}},"line":26},"10":{"name":"(anonymous_10)","decl":{"start":{"line":27,"column":47},"end":{"line":27,"column":48}},"loc":{"start":{"line":27,"column":60},"end":{"line":36,"column":9}},"line":27},"11":{"name":"(anonymous_11)","decl":{"start":{"line":38,"column":4},"end":{"line":38,"column":5}},"loc":{"start":{"line":38,"column":28},"end":{"line":48,"column":5}},"line":38},"12":{"name":"(anonymous_12)","decl":{"start":{"line":39,"column":47},"end":{"line":39,"column":48}},"loc":{"start":{"line":39,"column":60},"end":{"line":47,"column":9}},"line":39}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/enrollmentRepository.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/enrollmentRepository.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,8BAAyB;AAGzB,MAAa,oBAAoB;IAEvB,OAAO,CAAC,EAAU;;YACpB,MAAM,KAAK,GAAG;;;;;SAKb,CAAC;YACF,OAAO,MAAM,OAAE,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAC3C,CAAC;KAAA;IAEK,UAAU;;YACZ,MAAM,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;YACxB,MAAM,KAAK,GAAG;;;;;SAKb,CAAC;YACF,OAAO,MAAM,OAAE,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;QAC7C,CAAC;KAAA;IAEK,qBAAqB;;YACvB,MAAM,IAAI,GAAW,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,CAAC;YAC9C,MAAM,KAAK,GAAG;;;;SAIb,CAAC;YACF,OAAO,MAAM,OAAE,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;QACzC,CAAC;KAAA;CACJ;AAhCD,oDAgCC","sourcesContent":["import {db} from '../db';\nimport {EnrollmentEntity} from \"../models/enrollmentEntity\";\n\nexport class EnrollmentRepository {\n\n    async getById(id: number): Promise<EnrollmentEntity | null> {\n        const query = `\n            SELECT * \n            FROM enrollments \n            WHERE id = $1\n            LIMIT 1\n        `;\n        return await db.oneOrNone(query, [id]);\n    }\n\n    async getCurrent(): Promise<EnrollmentEntity | null> {\n        const date = new Date();\n        const query = `\n            SELECT *\n            FROM enrollments\n            WHERE start_date <= $1 AND end_date >= $1\n            LIMIT 1\n        `;\n        return await db.oneOrNone(query, [date]);\n    }\n\n    async getAllFromCurrentYear(): Promise<EnrollmentEntity[]> {\n        const year: number = new Date().getFullYear();\n        const query = `\n            SELECT *\n            FROM enrollments\n            WHERE date_part('year', end_date) = $1\n        `;\n        return await db.query(query, [year]);\n    }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"54d8df4558b58f47549d2edbd64c2842fbcb2999","contentHash":"df0cb8ba2e91a044bbf2bd5df7737e54abc3912da3de9b69b0d3297b77f691f7"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/gradeRepository.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/gradeRepository.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":33}},"14":{"start":{"line":13,"column":13},"end":{"line":13,"column":29}},"15":{"start":{"line":16,"column":8},"end":{"line":23,"column":11}},"16":{"start":{"line":17,"column":26},"end":{"line":21,"column":9}},"17":{"start":{"line":22,"column":12},"end":{"line":22,"column":61}},"18":{"start":{"line":26,"column":8},"end":{"line":34,"column":11}},"19":{"start":{"line":27,"column":26},"end":{"line":32,"column":9}},"20":{"start":{"line":33,"column":12},"end":{"line":33,"column":82}},"21":{"start":{"line":37,"column":8},"end":{"line":45,"column":11}},"22":{"start":{"line":38,"column":26},"end":{"line":43,"column":9}},"23":{"start":{"line":44,"column":12},"end":{"line":44,"column":65}},"24":{"start":{"line":48,"column":8},"end":{"line":54,"column":11}},"25":{"start":{"line":49,"column":26},"end":{"line":52,"column":9}},"26":{"start":{"line":53,"column":12},"end":{"line":53,"column":95}},"27":{"start":{"line":57,"column":0},"end":{"line":57,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":35},"end":{"line":24,"column":5}},"line":15},"8":{"name":"(anonymous_8)","decl":{"start":{"line":16,"column":47},"end":{"line":16,"column":48}},"loc":{"start":{"line":16,"column":60},"end":{"line":23,"column":9}},"line":16},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":4},"end":{"line":25,"column":5}},"loc":{"start":{"line":25,"column":60},"end":{"line":35,"column":5}},"line":25},"10":{"name":"(anonymous_10)","decl":{"start":{"line":26,"column":47},"end":{"line":26,"column":48}},"loc":{"start":{"line":26,"column":60},"end":{"line":34,"column":9}},"line":26},"11":{"name":"(anonymous_11)","decl":{"start":{"line":36,"column":4},"end":{"line":36,"column":5}},"loc":{"start":{"line":36,"column":32},"end":{"line":46,"column":5}},"line":36},"12":{"name":"(anonymous_12)","decl":{"start":{"line":37,"column":47},"end":{"line":37,"column":48}},"loc":{"start":{"line":37,"column":60},"end":{"line":45,"column":9}},"line":37},"13":{"name":"(anonymous_13)","decl":{"start":{"line":47,"column":4},"end":{"line":47,"column":5}},"loc":{"start":{"line":47,"column":21},"end":{"line":55,"column":5}},"line":47},"14":{"name":"(anonymous_14)","decl":{"start":{"line":48,"column":47},"end":{"line":48,"column":48}},"loc":{"start":{"line":48,"column":60},"end":{"line":54,"column":9}},"line":48}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/gradeRepository.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/gradeRepository.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,8BAAgC;AAGhC,MAAa,eAAe;IAElB,iBAAiB,CAAC,WAAmB;;YACvC,MAAM,KAAK,GAAG;;;;SAIb,CAAC;YAEF,OAAO,MAAM,OAAE,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;QAChD,CAAC;KAAA;IAEK,yBAAyB,CAAC,WAAmB,EAAE,SAAiB,EAAE,IAAY;;YAChF,MAAM,KAAK,GAAG;;;;;SAKb,CAAC;YAEF,OAAO,MAAM,OAAE,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,WAAW,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC,CAAC;QACrE,CAAC;KAAA;IAEK,cAAc,CAAC,WAAmB;;YACpC,MAAM,KAAK,GAAG;;;;;SAKb,CAAC;YAEF,OAAO,MAAM,OAAE,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;QACpD,CAAC;KAAA;IAGK,MAAM,CAAC,KAAkB,EAAE,CAAa;;YAC1C,MAAM,KAAK,GAAG;;;SAGb,CAAC;YAEF,MAAM,CAAC,CAAC,IAAI,CACR,KAAK,EACL,CAAC,KAAK,CAAC,WAAW,EAAE,KAAK,CAAC,SAAS,EAAE,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,IAAI,CAAC,CAChE,CAAC;QACN,CAAC;KAAA;CACJ;AA9CD,0CA8CC","sourcesContent":["import {db, ITask} from '../db';\nimport {GradeEntity} from \"../models/gradeEntity\";\n\nexport class GradeRepository {\n\n    async getAllByCandidate(candidateId: number): Promise<GradeEntity[]> {\n        const query = `\n            SELECT * \n            FROM grades\n            WHERE candidate_id = $1\n        `;\n\n        return await db.query(query, [candidateId]);\n    }\n\n    async getByCandidateSubjectType(candidateId: number, subjectId: number, type: string): Promise<GradeEntity | null> {\n        const query = `\n            SELECT * \n            FROM grades\n            WHERE candidate_id = $1 AND subject_id = $2 AND type = $3\n            LIMIT 1\n        `;\n\n        return await db.oneOrNone(query, [candidateId, subjectId, type]);\n    }\n\n    async getByCandidate(candidateId: number): Promise<GradeEntity | null> {\n        const query = `\n            SELECT * \n            FROM grades\n            WHERE candidate_id = $1\n            LIMIT 1\n        `;\n\n        return await db.oneOrNone(query, [candidateId]);\n    }\n\n\n    async insert(grade: GradeEntity, t: ITask<any>): Promise<void> {\n        const query = `\n            INSERT INTO grades (candidate_id, subject_id, grade, type)\n            VALUES ($1, $2, $3, $4)\n        `;\n\n        await t.none(\n            query,\n            [grade.candidateId, grade.subjectId, grade.grade, grade.type]\n        );\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9c8e51a81ec0a72558b922d1ff30c23465ad107c","contentHash":"523b6a37a5125cf8d1b8d7ffb4f4bde70b4e474a4cec6f00aa6f1c21df5f6181"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/subjectService.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/subjectService.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":32}},"14":{"start":{"line":15,"column":8},"end":{"line":15,"column":51}},"15":{"start":{"line":18,"column":8},"end":{"line":20,"column":11}},"16":{"start":{"line":19,"column":12},"end":{"line":19,"column":51}},"17":{"start":{"line":23,"column":0},"end":{"line":23,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":14,"column":4},"end":{"line":14,"column":5}},"loc":{"start":{"line":14,"column":35},"end":{"line":16,"column":5}},"line":14},"8":{"name":"(anonymous_8)","decl":{"start":{"line":17,"column":4},"end":{"line":17,"column":5}},"loc":{"start":{"line":17,"column":21},"end":{"line":21,"column":5}},"line":17},"9":{"name":"(anonymous_9)","decl":{"start":{"line":18,"column":47},"end":{"line":18,"column":48}},"loc":{"start":{"line":18,"column":60},"end":{"line":20,"column":9}},"line":18}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":0,"15":0,"16":0,"17":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/subjectService.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/subjectService.ts"],"names":[],"mappings":";;;;;;;;;;;;AAGA,MAAa,cAAc;IACvB,YAAoB,iBAAoC;QAApC,sBAAiB,GAAjB,iBAAiB,CAAmB;IAAG,CAAC;IAEtD,cAAc;;YAChB,OAAO,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC;QAC3C,CAAC;KAAA;CACJ;AAND,wCAMC","sourcesContent":["import {SubjectRepository} from \"../repositories/subjectRepository\";\nimport {Subject} from \"../dto/subject\";\n\nexport class SubjectService {\n    constructor(private subjectRepository: SubjectRepository) {}\n\n    async getAllSubjects(): Promise<Subject[]> {\n        return this.subjectRepository.getAll();\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"748a9aa97df27d16f0ac8f6a3718ea5c2a6b690f","contentHash":"77856f749e8adcabadf1787f726944ed976bf6349f1870c0d6afc0ed6e2cc44e"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/profileRepository.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/profileRepository.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":35}},"14":{"start":{"line":13,"column":13},"end":{"line":13,"column":29}},"15":{"start":{"line":16,"column":8},"end":{"line":24,"column":11}},"16":{"start":{"line":17,"column":26},"end":{"line":22,"column":9}},"17":{"start":{"line":23,"column":12},"end":{"line":23,"column":56}},"18":{"start":{"line":27,"column":8},"end":{"line":34,"column":11}},"19":{"start":{"line":28,"column":26},"end":{"line":32,"column":9}},"20":{"start":{"line":33,"column":12},"end":{"line":33,"column":58}},"21":{"start":{"line":37,"column":8},"end":{"line":43,"column":11}},"22":{"start":{"line":38,"column":26},"end":{"line":41,"column":9}},"23":{"start":{"line":42,"column":12},"end":{"line":42,"column":46}},"24":{"start":{"line":46,"column":8},"end":{"line":52,"column":11}},"25":{"start":{"line":47,"column":26},"end":{"line":50,"column":9}},"26":{"start":{"line":51,"column":12},"end":{"line":51,"column":46}},"27":{"start":{"line":55,"column":0},"end":{"line":55,"column":46}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":16},"end":{"line":25,"column":5}},"line":15},"8":{"name":"(anonymous_8)","decl":{"start":{"line":16,"column":47},"end":{"line":16,"column":48}},"loc":{"start":{"line":16,"column":60},"end":{"line":24,"column":9}},"line":16},"9":{"name":"(anonymous_9)","decl":{"start":{"line":26,"column":4},"end":{"line":26,"column":5}},"loc":{"start":{"line":26,"column":29},"end":{"line":35,"column":5}},"line":26},"10":{"name":"(anonymous_10)","decl":{"start":{"line":27,"column":47},"end":{"line":27,"column":48}},"loc":{"start":{"line":27,"column":60},"end":{"line":34,"column":9}},"line":27},"11":{"name":"(anonymous_11)","decl":{"start":{"line":36,"column":4},"end":{"line":36,"column":5}},"loc":{"start":{"line":36,"column":13},"end":{"line":44,"column":5}},"line":36},"12":{"name":"(anonymous_12)","decl":{"start":{"line":37,"column":47},"end":{"line":37,"column":48}},"loc":{"start":{"line":37,"column":60},"end":{"line":43,"column":9}},"line":37},"13":{"name":"(anonymous_13)","decl":{"start":{"line":45,"column":4},"end":{"line":45,"column":5}},"loc":{"start":{"line":45,"column":29},"end":{"line":53,"column":5}},"line":45},"14":{"name":"(anonymous_14)","decl":{"start":{"line":46,"column":47},"end":{"line":46,"column":48}},"loc":{"start":{"line":46,"column":60},"end":{"line":52,"column":9}},"line":46}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/profileRepository.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/profileRepository.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,8BAAyB;AAIzB,MAAa,iBAAiB;IACpB,OAAO,CAAC,EAAU;;YACpB,MAAM,KAAK,GAAG;;;;;SAKb,CAAC;YAEF,OAAO,MAAM,OAAE,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAC3C,CAAC;KAAA;IAEK,cAAc,CAAC,QAAgB;;YACjC,MAAM,KAAK,GAAG;;;;SAIb,CAAC;YAEF,OAAO,MAAM,OAAE,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC;QAC7C,CAAC;KAAA;IAEK,MAAM;;YACR,MAAM,KAAK,GAAG;;;SAGb,CAAC;YAEF,OAAO,MAAM,OAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QACjC,CAAC;KAAA;IAEK,sBAAsB;;YACxB,MAAM,KAAK,GAAG;;;SAGb,CAAC;YAEF,OAAO,MAAM,OAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QACjC,CAAC;KAAA;CACJ;AAvCD,8CAuCC","sourcesContent":["import {db} from '../db';\nimport {ProfileEntity} from \"../models/profileEntity\";\nimport {ProfileCriteriaEntity} from \"../models/profileCriteriaEntity\";\n\nexport class ProfileRepository {\n    async getById(id: number): Promise<ProfileEntity | null> {\n        const query = `\n            SELECT * \n            FROM profiles\n            WHERE id = $1\n            LIMIT 1\n        `;\n\n        return await db.oneOrNone(query, [id]);\n    }\n\n    async getAllBySchool(schoolId: number): Promise<ProfileEntity[]> {\n        const query = `\n            SELECT *\n            FROM profiles\n            WHERE school_Id = $1;\n        `;\n\n        return await db.query(query, [schoolId]);\n    }\n\n    async getAll(): Promise<ProfileEntity[]> {\n        const query = `\n            SELECT *\n            FROM profiles\n        `;\n\n        return await db.query(query);\n    }\n\n    async getAllProfilesCriteria(): Promise<ProfileCriteriaEntity[]> {\n        const query = `\n            SELECT *\n            FROM profile_criteria\n        `;\n\n        return await db.query(query);\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a8ef19a7c844207d323c22da264a727c61ccbc43","contentHash":"265deb2fc784608e917d48e22005486e5d674d67f6cf1e9306a214ce04224236"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/schoolRepository.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/schoolRepository.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":34}},"14":{"start":{"line":13,"column":13},"end":{"line":13,"column":29}},"15":{"start":{"line":16,"column":8},"end":{"line":24,"column":11}},"16":{"start":{"line":17,"column":26},"end":{"line":22,"column":9}},"17":{"start":{"line":23,"column":12},"end":{"line":23,"column":56}},"18":{"start":{"line":27,"column":8},"end":{"line":33,"column":11}},"19":{"start":{"line":28,"column":26},"end":{"line":31,"column":9}},"20":{"start":{"line":32,"column":12},"end":{"line":32,"column":46}},"21":{"start":{"line":36,"column":8},"end":{"line":43,"column":11}},"22":{"start":{"line":37,"column":26},"end":{"line":40,"column":9}},"23":{"start":{"line":41,"column":27},"end":{"line":41,"column":43}},"24":{"start":{"line":42,"column":12},"end":{"line":42,"column":47}},"25":{"start":{"line":46,"column":0},"end":{"line":46,"column":44}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":16},"end":{"line":25,"column":5}},"line":15},"8":{"name":"(anonymous_8)","decl":{"start":{"line":16,"column":47},"end":{"line":16,"column":48}},"loc":{"start":{"line":16,"column":60},"end":{"line":24,"column":9}},"line":16},"9":{"name":"(anonymous_9)","decl":{"start":{"line":26,"column":4},"end":{"line":26,"column":5}},"loc":{"start":{"line":26,"column":13},"end":{"line":34,"column":5}},"line":26},"10":{"name":"(anonymous_10)","decl":{"start":{"line":27,"column":47},"end":{"line":27,"column":48}},"loc":{"start":{"line":27,"column":60},"end":{"line":33,"column":9}},"line":27},"11":{"name":"(anonymous_11)","decl":{"start":{"line":35,"column":4},"end":{"line":35,"column":5}},"loc":{"start":{"line":35,"column":22},"end":{"line":44,"column":5}},"line":35},"12":{"name":"(anonymous_12)","decl":{"start":{"line":36,"column":47},"end":{"line":36,"column":48}},"loc":{"start":{"line":36,"column":60},"end":{"line":43,"column":9}},"line":36}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/schoolRepository.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/schoolRepository.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,8BAAyB;AAGzB,MAAa,gBAAgB;IACnB,OAAO,CAAC,EAAU;;YACpB,MAAM,KAAK,GAAG;;;;;SAKb,CAAC;YAEF,OAAO,MAAM,OAAE,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAC3C,CAAC;KAAA;IAEK,MAAM;;YACR,MAAM,KAAK,GAAG;;;SAGb,CAAC;YAEF,OAAO,MAAM,OAAE,CAAC,KAAK,CAAiB,KAAK,CAAC,CAAC;QACjD,CAAC;KAAA;IAEK,MAAM,CAAC,SAAuB;;YAChC,MAAM,KAAK,GAAG;;;SAGb,CAAC;YACF,MAAM,MAAM,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;YAEhC,MAAM,OAAE,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;QAClC,CAAC;KAAA;CACJ;AA9BD,4CA8BC","sourcesContent":["import {db} from '../db';\nimport {SchoolEntity} from \"../models/schoolEntity\";\n\nexport class SchoolRepository {\n    async getById(id: number): Promise<SchoolEntity | null> {\n        const query = `\n            SELECT *\n            FROM schools \n            WHERE id = $1\n            LIMIT 1\n        `;\n\n        return await db.oneOrNone(query, [id]);\n    }\n\n    async getAll(): Promise<SchoolEntity[]> {\n        const query = `\n            SELECT id, name \n            FROM schools;\n        `;\n\n        return await db.query<SchoolEntity[]>(query);\n    }\n\n    async insert(newSchool: SchoolEntity): Promise<void> {\n        const query = `\n            INSERT INTO schools (name, type)\n            VALUES ($1, $2)\n        `;\n        const values = [newSchool.name];\n\n        await db.query(query, values);\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3ae5d623eafc80433870139131c7f3f16c8b71d3","contentHash":"222eba7b45bc2b851be6c1c4af9b07f415cf0be1d44a125dbdb8a82599953c9b"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/subjectRepository.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/subjectRepository.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":35}},"14":{"start":{"line":13,"column":13},"end":{"line":13,"column":29}},"15":{"start":{"line":16,"column":8},"end":{"line":22,"column":11}},"16":{"start":{"line":17,"column":26},"end":{"line":20,"column":9}},"17":{"start":{"line":21,"column":12},"end":{"line":21,"column":54}},"18":{"start":{"line":25,"column":0},"end":{"line":25,"column":46}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":13},"end":{"line":23,"column":5}},"line":15},"8":{"name":"(anonymous_8)","decl":{"start":{"line":16,"column":47},"end":{"line":16,"column":48}},"loc":{"start":{"line":16,"column":60},"end":{"line":22,"column":9}},"line":16}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":21,"column":19},"end":{"line":21,"column":53}},"type":"binary-expr","locations":[{"start":{"line":21,"column":20},"end":{"line":21,"column":46}},{"start":{"line":21,"column":51},"end":{"line":21,"column":53}}],"line":21}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/subjectRepository.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/subjectRepository.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,8BAAyB;AAGzB,MAAa,iBAAiB;IACpB,MAAM;;YACR,MAAM,KAAK,GAAG;;;SAGb,CAAC;YAEF,OAAO,CAAA,MAAM,OAAE,CAAC,KAAK,CAAC,KAAK,CAAC,KAAI,EAAE,CAAC;QACvC,CAAC;KAAA;CACJ;AATD,8CASC","sourcesContent":["import {db} from '../db';\nimport {SubjectEntity} from \"../models/subjectEntity\";\n\nexport class SubjectRepository {\n    async getAll(): Promise<SubjectEntity[]> {\n        const query = `\n            SELECT * \n            FROM subjects\n        `;\n\n        return await db.query(query) || [];\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"48809ce2887685eb0ef0b2fab58d0cacb9c9c84d","contentHash":"d93a3d0b9ce7cb404d73fc7946d8d4358386d3f9c220a0a4796d98b85cccb1c2"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/userService.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/userService.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":29}},"14":{"start":{"line":13,"column":17},"end":{"line":13,"column":34}},"15":{"start":{"line":14,"column":30},"end":{"line":14,"column":70}},"16":{"start":{"line":15,"column":28},"end":{"line":15,"column":66}},"17":{"start":{"line":18,"column":8},"end":{"line":18,"column":45}},"18":{"start":{"line":19,"column":8},"end":{"line":19,"column":21}},"19":{"start":{"line":22,"column":8},"end":{"line":28,"column":11}},"20":{"start":{"line":23,"column":33},"end":{"line":23,"column":99}},"21":{"start":{"line":24,"column":12},"end":{"line":26,"column":13}},"22":{"start":{"line":25,"column":16},"end":{"line":25,"column":92}},"23":{"start":{"line":27,"column":12},"end":{"line":27,"column":32}},"24":{"start":{"line":31,"column":8},"end":{"line":52,"column":11}},"25":{"start":{"line":32,"column":33},"end":{"line":32,"column":115}},"26":{"start":{"line":33,"column":12},"end":{"line":40,"column":13}},"27":{"start":{"line":34,"column":16},"end":{"line":36,"column":17}},"28":{"start":{"line":35,"column":20},"end":{"line":35,"column":98}},"29":{"start":{"line":37,"column":16},"end":{"line":39,"column":17}},"30":{"start":{"line":38,"column":20},"end":{"line":38,"column":116}},"31":{"start":{"line":41,"column":35},"end":{"line":41,"column":78}},"32":{"start":{"line":42,"column":28},"end":{"line":47,"column":13}},"33":{"start":{"line":48,"column":12},"end":{"line":51,"column":16}},"34":{"start":{"line":48,"column":33},"end":{"line":51,"column":14}},"35":{"start":{"line":49,"column":29},"end":{"line":49,"column":73}},"36":{"start":{"line":50,"column":16},"end":{"line":50,"column":80}},"37":{"start":{"line":55,"column":0},"end":{"line":55,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":17,"column":4},"end":{"line":17,"column":5}},"loc":{"start":{"line":17,"column":36},"end":{"line":20,"column":5}},"line":17},"8":{"name":"(anonymous_8)","decl":{"start":{"line":21,"column":4},"end":{"line":21,"column":5}},"loc":{"start":{"line":21,"column":27},"end":{"line":29,"column":5}},"line":21},"9":{"name":"(anonymous_9)","decl":{"start":{"line":22,"column":47},"end":{"line":22,"column":48}},"loc":{"start":{"line":22,"column":60},"end":{"line":28,"column":9}},"line":22},"10":{"name":"(anonymous_10)","decl":{"start":{"line":30,"column":4},"end":{"line":30,"column":5}},"loc":{"start":{"line":30,"column":19},"end":{"line":53,"column":5}},"line":30},"11":{"name":"(anonymous_11)","decl":{"start":{"line":31,"column":47},"end":{"line":31,"column":48}},"loc":{"start":{"line":31,"column":60},"end":{"line":52,"column":9}},"line":31},"12":{"name":"(anonymous_12)","decl":{"start":{"line":48,"column":26},"end":{"line":48,"column":27}},"loc":{"start":{"line":48,"column":33},"end":{"line":51,"column":14}},"line":48},"13":{"name":"(anonymous_13)","decl":{"start":{"line":48,"column":65},"end":{"line":48,"column":66}},"loc":{"start":{"line":48,"column":78},"end":{"line":51,"column":13}},"line":48}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":24,"column":12},"end":{"line":26,"column":13}},"type":"if","locations":[{"start":{"line":24,"column":12},"end":{"line":26,"column":13}},{"start":{},"end":{}}],"line":24},"6":{"loc":{"start":{"line":24,"column":16},"end":{"line":24,"column":96}},"type":"binary-expr","locations":[{"start":{"line":24,"column":16},"end":{"line":24,"column":29}},{"start":{"line":24,"column":33},"end":{"line":24,"column":96}}],"line":24},"7":{"loc":{"start":{"line":33,"column":12},"end":{"line":40,"column":13}},"type":"if","locations":[{"start":{"line":33,"column":12},"end":{"line":40,"column":13}},{"start":{},"end":{}}],"line":33},"8":{"loc":{"start":{"line":34,"column":16},"end":{"line":36,"column":17}},"type":"if","locations":[{"start":{"line":34,"column":16},"end":{"line":36,"column":17}},{"start":{},"end":{}}],"line":34},"9":{"loc":{"start":{"line":37,"column":16},"end":{"line":39,"column":17}},"type":"if","locations":[{"start":{"line":37,"column":16},"end":{"line":39,"column":17}},{"start":{},"end":{}}],"line":37}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":1,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/userService.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/services/userService.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,mCAAqC;AAKrC,uEAAkE;AAClE,mEAA8D;AAM9D,MAAa,WAAW;IACpB,YACY,cAA8B,EACrB,EAAuB;QADhC,mBAAc,GAAd,cAAc,CAAgB;QACrB,OAAE,GAAF,EAAE,CAAqB;IACzC,CAAC;IAEE,KAAK,CAAC,KAAa,EAAE,QAAgB;;YACvC,MAAM,YAAY,GAAyB,MAAM,IAAI,CAAC,cAAc,CAAC,0BAA0B,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;YAC9G,IAAI,CAAC,YAAY,IAAI,CAAC,CAAC,MAAM,IAAA,gBAAO,EAAC,QAAQ,EAAE,YAAY,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC;gBACrE,MAAM,IAAI,yCAAmB,CAAC,sBAAsB,CAAC,CAAC;YAC1D,CAAC;YAED,OAAO,YAAY,CAAC;QACxB,CAAC;KAAA;IAEK,QAAQ,CAAC,IAAiB;;YAC5B,MAAM,YAAY,GAAgB,MAAM,IAAI,CAAC,cAAc,CAAC,6BAA6B,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;YACrH,IAAI,YAAY,EAAE,CAAC;gBACf,IAAI,YAAY,CAAC,QAAQ,KAAK,IAAI,CAAC,QAAQ,EAAE,CAAC;oBAC1C,MAAM,IAAI,qCAAiB,CAAC,4BAA4B,CAAC,CAAC;gBAC9D,CAAC;gBACD,IAAI,YAAY,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK,EAAE,CAAC;oBACpC,MAAM,IAAI,qCAAiB,CAAC,8CAA8C,CAAC,CAAC;gBAChF,CAAC;YACL,CAAC;YAED,MAAM,cAAc,GAAW,MAAM,IAAA,aAAI,EAAC,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;YAC7D,MAAM,OAAO,GAAe;gBACxB,EAAE,EAAE,CAAC;gBACL,QAAQ,EAAE,IAAI,CAAC,QAAQ;gBACvB,KAAK,EAAE,IAAI,CAAC,KAAK;gBACjB,QAAQ,EAAE,cAAc;aAC3B,CAAC;YAEF,MAAM,IAAI,CAAC,EAAE,CAAC,CAAM,CAAC,EAAC,EAAE;gBACpB,MAAM,IAAI,GAAe,MAAM,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;gBACtE,MAAM,IAAI,CAAC,cAAc,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;YACpE,CAAC,CAAA,CAAC,CAAC;QACP,CAAC;KAAA;CACJ;AAvCD,kCAuCC","sourcesContent":["import {compare, hash} from 'bcrypt';\n\nimport {transactionFunction} from \"../db\";\n\nimport {UserRepository} from '../repositories/userRepository';\nimport {AuthenticationError} from \"../errors/authenticationError\";\nimport {DataConflictError} from \"../errors/dataConflictError\";\nimport {userRequest} from \"../dto/userRequest\";\nimport {UserWithRoles} from \"../dto/userWithRoles\";\nimport {User} from \"../dto/user\";\nimport {UserEntity} from \"../models/userEntity\";\n\nexport class UserService {\n    constructor(\n        private userRepository: UserRepository,\n        private readonly tx: transactionFunction\n    ) {}\n\n    async login(login: string, password: string): Promise<UserWithRoles> {\n        const existingUser: UserWithRoles | null = await this.userRepository.getWithRolesByLoginOrEmail(login, login);\n        if (!existingUser || !(await compare(password, existingUser.password))) {\n            throw new AuthenticationError('Invalid credentials.');\n        }\n\n        return existingUser;\n    }\n\n    async register(user: userRequest): Promise<void> {\n        const existingUser: User | null = await this.userRepository.getWithoutRolesByLoginOrEmail(user.username, user.email);\n        if (existingUser) {\n            if (existingUser.username === user.username) {\n                throw new DataConflictError('Username is already taken.');\n            }\n            if (existingUser.email === user.email) {\n                throw new DataConflictError('There is already an account with that email.');\n            }\n        }\n\n        const hashedPassword: string = await hash(user.password, 12);\n        const newUser: UserEntity = {\n            id: 0,\n            username: user.username,\n            email: user.email,\n            password: hashedPassword,\n        };\n\n        await this.tx(async t => {\n            const user: UserEntity = await this.userRepository.insert(newUser, t);\n            await this.userRepository.insertUserRoles(user.id, ['user'], t);\n        });\n    }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"cb038df735822cda842af7e175c0d1b3f3143528","contentHash":"dacd8fa6ded44e63d966353cb17d33d800103f2731a6df72353876be05aaf1ba"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/authenticationError.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/authenticationError.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"2":{"start":{"line":4,"column":22},"end":{"line":4,"column":46}},"3":{"start":{"line":7,"column":8},"end":{"line":7,"column":28}},"4":{"start":{"line":10,"column":0},"end":{"line":10,"column":50}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":51},"end":{"line":8,"column":5}},"line":6}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":16},"end":{"line":6,"column":49}},"type":"default-arg","locations":[{"start":{"line":6,"column":26},"end":{"line":6,"column":49}}],"line":6}},"s":{"0":1,"1":1,"2":1,"3":0,"4":1},"f":{"0":0},"b":{"0":[0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/authenticationError.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/errors/authenticationError.ts"],"names":[],"mappings":";;;AAAA,+CAA0C;AAE1C,MAAa,mBAAoB,SAAQ,yBAAW;IAChD,YAAY,UAAkB,uBAAuB;QACjD,KAAK,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;IACxB,CAAC;CACJ;AAJD,kDAIC","sourcesContent":["import {CustomError} from \"./customError\";\n\nexport class AuthenticationError extends CustomError {\n    constructor(message: string = 'Authentication failed') {\n        super(message, 401);\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b2cd7b2db26c1ac53719a179c57d05fbf689892f","contentHash":"5ae3a9ba9ae0bfaeeaa3d10fe261e7a1eec83d463cfe1cfd8dcf8bc318dc9ce7"},"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/userRepository.ts":{"path":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/userRepository.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":32}},"14":{"start":{"line":13,"column":13},"end":{"line":13,"column":29}},"15":{"start":{"line":16,"column":8},"end":{"line":24,"column":11}},"16":{"start":{"line":17,"column":36},"end":{"line":21,"column":9}},"17":{"start":{"line":22,"column":27},"end":{"line":22,"column":78}},"18":{"start":{"line":23,"column":12},"end":{"line":23,"column":50}},"19":{"start":{"line":27,"column":8},"end":{"line":35,"column":11}},"20":{"start":{"line":28,"column":26},"end":{"line":31,"column":9}},"21":{"start":{"line":32,"column":12},"end":{"line":34,"column":13}},"22":{"start":{"line":33,"column":16},"end":{"line":33,"column":56}},"23":{"start":{"line":38,"column":8},"end":{"line":49,"column":11}},"24":{"start":{"line":39,"column":26},"end":{"line":47,"column":9}},"25":{"start":{"line":48,"column":12},"end":{"line":48,"column":69}},"26":{"start":{"line":52,"column":8},"end":{"line":61,"column":11}},"27":{"start":{"line":53,"column":26},"end":{"line":59,"column":9}},"28":{"start":{"line":60,"column":12},"end":{"line":60,"column":69}},"29":{"start":{"line":64,"column":0},"end":{"line":64,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":23},"end":{"line":25,"column":5}},"line":15},"8":{"name":"(anonymous_8)","decl":{"start":{"line":16,"column":47},"end":{"line":16,"column":48}},"loc":{"start":{"line":16,"column":60},"end":{"line":24,"column":9}},"line":16},"9":{"name":"(anonymous_9)","decl":{"start":{"line":26,"column":4},"end":{"line":26,"column":5}},"loc":{"start":{"line":26,"column":38},"end":{"line":36,"column":5}},"line":26},"10":{"name":"(anonymous_10)","decl":{"start":{"line":27,"column":47},"end":{"line":27,"column":48}},"loc":{"start":{"line":27,"column":60},"end":{"line":35,"column":9}},"line":27},"11":{"name":"(anonymous_11)","decl":{"start":{"line":37,"column":4},"end":{"line":37,"column":5}},"loc":{"start":{"line":37,"column":48},"end":{"line":50,"column":5}},"line":37},"12":{"name":"(anonymous_12)","decl":{"start":{"line":38,"column":47},"end":{"line":38,"column":48}},"loc":{"start":{"line":38,"column":60},"end":{"line":49,"column":9}},"line":38},"13":{"name":"(anonymous_13)","decl":{"start":{"line":51,"column":4},"end":{"line":51,"column":5}},"loc":{"start":{"line":51,"column":51},"end":{"line":62,"column":5}},"line":51},"14":{"name":"(anonymous_14)","decl":{"start":{"line":52,"column":47},"end":{"line":52,"column":48}},"loc":{"start":{"line":52,"column":60},"end":{"line":61,"column":9}},"line":52}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"file":"/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/userRepository.ts","sources":["/home/julia/praca_inżynierska/electronic-school-enrollment-system/server/src/repositories/userRepository.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,8BAAgC;AAIhC,MAAa,cAAc;IAEjB,MAAM,CAAC,OAAmB,EAAE,CAAa;;YAC3C,MAAM,eAAe,GAAG;;;;SAIvB,CAAC;YAEF,MAAM,MAAM,GAAG,CAAC,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC;YACnE,OAAO,CAAC,CAAC,GAAG,CAAC,eAAe,EAAE,MAAM,CAAC,CAAC;QAC1C,CAAC;KAAA;IAEK,eAAe,CAAC,MAAc,EAAE,KAAe,EAAE,CAAa;;YAChE,MAAM,KAAK,GAAG;;;SAGb,CAAC;YAEF,KAAK,MAAM,QAAQ,IAAI,KAAK,EAAE,CAAC;gBAC3B,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC,CAAC;YAC5C,CAAC;QACL,CAAC;KAAA;IAEK,0BAA0B,CAAC,QAAgB,EAAE,KAAa;;YAC5D,MAAM,KAAK,GAAG;;;;;;;;SAQb,CAAC;YACF,OAAO,MAAM,OAAE,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC,CAAC;QACxD,CAAC;KAAA;IAEK,6BAA6B,CAAC,QAAgB,EAAE,KAAa;;YAC/D,MAAM,KAAK,GAAG;;;;;;SAMb,CAAC;YAEF,OAAO,MAAM,OAAE,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC,CAAC;QACxD,CAAC;KAAA;CACJ;AAhDD,wCAgDC","sourcesContent":["import {db, ITask} from '../db';\nimport {UserEntity} from \"../models/userEntity\";\nimport {UserEntityWithRoles} from \"../models/userEntityWithRoles\";\n\nexport class UserRepository {\n\n    async insert(newUser: UserEntity, t: ITask<any>): Promise<UserEntity> {\n        const userInsertQuery = `\n            INSERT INTO users (username, email, password)\n            VALUES ($1, $2, $3)\n            RETURNING id;\n        `;\n\n        const values = [newUser.username, newUser.email, newUser.password];\n        return t.one(userInsertQuery, values);\n    }\n\n    async insertUserRoles(userId: number, roles: string[], t: ITask<any>): Promise<void> {\n        const query = `\n            INSERT INTO user_roles (user_id, role_name)\n            VALUES ($1, $2);\n        `;\n\n        for (const roleName of roles) {\n            await t.none(query, [userId, roleName]);\n        }\n    }\n\n    async getWithRolesByLoginOrEmail(username: string, email: string): Promise<UserEntityWithRoles | null> {\n        const query = `\n            SELECT u.*, array_agg(r.role_name) as roles\n            FROM users u\n                     LEFT JOIN user_roles r ON u.id = r.user_id\n            WHERE u.username = $1\n               or u.email = $2\n            GROUP BY u.id\n            LIMIT 1\n        `;\n        return await db.oneOrNone(query, [username, email]);\n    }\n\n    async getWithoutRolesByLoginOrEmail(username: string, email: string): Promise<UserEntity | null> {\n        const query = `\n            SELECT *\n            FROM users\n            WHERE username = $1\n               OR email = $2\n            LIMIT 1;\n        `;\n\n        return await db.oneOrNone(query, [username, email]);\n    }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"769a46306559394e7c4b88c911416147ad42e0d3","contentHash":"f3b4a37a72a374b5b8cd47f5045e2252c9616ed26c1eae709b845db32acac8c6"}}